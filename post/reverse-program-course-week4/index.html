<!DOCTYPE html>
<html lang="zh" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content="æ±‡ç¼–è¯­è¨€é¢„å¤‡çŸ¥è¯† æŒ‡ä»¤ç®€ä»‹ä¸æ€»è§ˆ æ±‡ç¼–æŒ‡ä»¤ æŒ‡ä»¤æ ¼å¼ åŠŸèƒ½ å¤‡æ³¨ lea lea reg, addr ä¸»è¦ç”¨äºå°†ä¸€ä¸ªå†…å­˜åœ°å€åŠ è½½åˆ°å¯„å­˜å™¨ä¸­ï¼Œ\nè€Œä¸æ˜¯å°†è¯¥åœ°å€å¤„çš„æ•°æ®åŠ è½½åˆ°å¯„å­˜å™¨ã€‚ å¦‚åœ¨printfå‡½æ•°ä¸­ï¼Œå°†æ ¼å¼å­—ç¬¦ä¸²çš„åœ°å€åŠ è½½åˆ°æŒ‡å®šå¯„å­˜å™¨ä¸­ä¾›printfå‡½æ•°è¯»å–ã€‚ inc inc reg å¯„å­˜å™¨è‡ªå¢1 å˜é‡åŠ ä¸€ mov mov reg, imm å°†ç«‹å³æ•°èµ‹å€¼åˆ°å¯„å­˜å™¨ä¸­ immæ„ä¸ºç«‹å³æ•°(immediate number) imul æŒ‡ä»¤æ ¼å¼è§è¯¦è§£ ç”¨äºæ‰§è¡Œå¸¦ç¬¦å·æ•´æ•°ä¹˜æ³•ã€‚ å®ƒå¯ä»¥æ¥å—ä¸€ä¸ªã€ä¸¤ä¸ªæˆ–ä¸‰ä¸ªæ“ä½œæ•°ï¼Œå…·ä½“å–å†³äºä½ æƒ³è¦æ‰§è¡Œçš„ä¹˜æ³•ç±»å‹ã€‚ mul mul source ç”¨äºæ‰§è¡Œæ— ç¬¦å·æ•´æ•°ä¹˜æ³•ã€‚ mul æŒ‡ä»¤åªæ¥å—ä¸€ä¸ªæ“ä½œæ•°ï¼Œè¿™ä¸ªæ“ä½œæ•°å¯ä»¥æ˜¯å¯„å­˜å™¨æˆ–å†…å­˜åœ°å€ã€‚æ ¹æ®æ“ä½œæ•°çš„å¤§å°ï¼ˆ8ä½ã€16ä½ã€32ä½æˆ–64ä½ï¼‰ï¼Œä¹˜ç§¯ä¼šè¢«å­˜å‚¨åœ¨ç‰¹å®šçš„å¯„å­˜å™¨ç»„åˆä¸­ã€‚ shl/shr shl/shr dest, cnt é€»è¾‘å·¦/å³ç§» shrç”¨äºå°†å¯„å­˜å™¨æˆ–å†…å­˜ä¸­çš„äºŒè¿›åˆ¶æ•°å€¼å‘å³ç§»åŠ¨æŒ‡å®šçš„ä½æ•°ã€‚è¿™ä¸ªæ“ä½œä¼šå°†æ¯ä¸ªä½éƒ½å‘å³ç§»åŠ¨ï¼Œå¹¶åœ¨å·¦ä¾§è¡¥0ã€‚å¯¹äºæ— ç¬¦å·æ•°æ¥è¯´ï¼Œè¿™ç›¸å½“äºé™¤ä»¥2çš„å¹‚æ¬¡ï¼›è€Œå¯¹äºæœ‰ç¬¦å·æ•°ï¼Œå®ƒä»…å½“è¢«ç§»ä½çš„æ•°æ®è§†ä¸ºæ— ç¬¦å·æ—¶æœ‰æ•ˆï¼Œå› ä¸ºé€»è¾‘å³ç§»ä¸ä¼šå¤åˆ¶ç¬¦å·ä½ã€‚ sar sar dest, count ç®—æœ¯å·¦/å³ç§» saræŒ‡ä»¤ç”¨äºå°†æŒ‡å®šçš„äºŒè¿›åˆ¶æ•°æŒ‰ç®—æœ¯å³ç§»çš„æ–¹å¼ç§»åŠ¨æŒ‡å®šçš„ä½æ•°ã€‚ç®—æœ¯å³ç§»æ˜¯æŒ‡åœ¨å³ç§»æ—¶ï¼Œæœ€é«˜ä½ï¼ˆç¬¦å·ä½ï¼‰ä¿æŒä¸å˜ï¼Œä½ä½ç§»å‡ºï¼Œé«˜ä½è¡¥ä¸Šç¬¦å·ä½çš„å€¼ã€‚è¿™é€šå¸¸ç”¨äºæœ‰ç¬¦å·æ•°çš„é™¤ä»¥2çš„å¹‚æ¬¡æ“ä½œã€‚ cdq cdq å°†32ä½å¯„å­˜å™¨eaxä¸­çš„æœ‰ç¬¦å·æ•°ç¬¦å·æ‰©å±•ä¸º64ä½ï¼Œç»“æœå­˜å‚¨åœ¨ç”±edx:eaxç»„æˆçš„64ä½å¯„å­˜å™¨ä¸­ å®ƒä¼šæŠŠeaxçš„ç¬¬31ä½ï¼ˆç¬¦å·ä½ï¼‰å¤åˆ¶åˆ°edxçš„æ¯ä¸€ä½ã€‚å¦‚æœeaxçš„ç¬¦å·ä½æ˜¯0ï¼ˆå³æ­£æ•°ï¼‰ï¼Œåˆ™edxä¼šè¢«è®¾ç½®ä¸º0ï¼›å¦‚æœç¬¦å·ä½æ˜¯1ï¼ˆå³è´Ÿæ•°ï¼‰ï¼Œåˆ™edxä¼šè¢«è®¾ç½®ä¸ºå…¨1ã€‚\né€šå¸¸åœ¨æ‰§è¡Œ32ä½æœ‰ç¬¦å·é™¤æ³•ï¼ˆå¦‚idivæŒ‡ä»¤ï¼‰ä¹‹å‰ä½¿ç”¨ï¼Œä»¥ç¡®ä¿è¢«é™¤æ•°çš„ç¬¦å·ä½æ­£ç¡®æ‰©å±•åˆ°é«˜ä½å¯„å­˜å™¨ï¼Œä»è€Œä¿è¯é™¤æ³•è¿ç®—çš„æ­£ç¡®æ€§ã€‚ cqo cqo å°†64ä½å¯„å­˜å™¨raxä¸­çš„æœ‰ç¬¦å·æ•°ç¬¦å·æ‰©å±•ä¸º128ä½ï¼Œç»“æœå­˜å‚¨åœ¨ç”±rdx:raxç»„æˆçš„128ä½å¯„å­˜å™¨ä¸­ å®ƒä¼šæŠŠraxçš„ç¬¬63ä½ï¼ˆç¬¦å·ä½ï¼‰å¤åˆ¶åˆ°rdxçš„æ¯ä¸€ä½ã€‚å¦‚æœraxçš„ç¬¦å·ä½æ˜¯0ï¼Œåˆ™rdxè¢«è®¾ç½®ä¸º0ï¼›å¦‚æœç¬¦å·ä½æ˜¯1ï¼Œåˆ™rdxè¢«è®¾ç½®ä¸ºå…¨1ã€‚\nåœ¨64ä½æ¨¡å¼ä¸‹ï¼Œé€šå¸¸åœ¨æ‰§è¡Œ64ä½æœ‰ç¬¦å·é™¤æ³•ä¹‹å‰ä½¿ç”¨ï¼Œç¡®ä¿è¢«é™¤æ•°çš„ç¬¦å·ä½æ­£ç¡®æ‰©å±•åˆ°é«˜ä½å¯„å­˜å™¨ã€‚ imul - å¸¦ç¬¦å·æ•´æ•°ä¹˜æ³• ä¸€ä¸ªæ“ä½œæ•° imul src \u200b\tè¿™ç§å½¢å¼å‡è®¾éšå«çš„ç›®æ ‡æ“ä½œæ•°æ˜¯ç´¯åŠ å™¨ï¼ˆå¯¹äº16ä½æ“ä½œä¸ºAXï¼Œå¯¹äº32ä½æ“ä½œä¸ºEAXï¼Œå¯¹äº64ä½æ“ä½œä¸ºRAXï¼‰ã€‚è¯¥æŒ‡ä»¤å°†ç´¯åŠ å™¨ä¸sourceç›¸ä¹˜ï¼Œå¹¶å°†ç»“æœå­˜å‚¨å›ç´¯åŠ å™¨å’Œå…¶å¯¹åº”çš„åŒå€å®½åº¦å¯„å­˜å™¨ï¼ˆå³å¯¹äº16ä½æ“ä½œä¸ºDX:AXï¼Œå¯¹äº32ä½æ“ä½œä¸ºEDX:EAXï¼Œå¯¹äº64ä½æ“ä½œä¸ºRDX:RAXï¼‰ã€‚\nä¸¤ä¸ªæ“ä½œæ•° imul dest, source \u200b\tè¿™ç§å½¢å¼å°†sourceä¸destç›¸ä¹˜ï¼Œå¹¶å°†ç»“æœå­˜å‚¨åœ¨destä¸­ã€‚destå¯ä»¥æ˜¯ä¸€ä¸ªå¯„å­˜å™¨æˆ–å†…å­˜ä½ç½®ï¼Œè€Œsourceå¯ä»¥æ˜¯ä¸€ä¸ªå¯„å­˜å™¨ã€å†…å­˜ä½ç½®æˆ–ç«‹å³æ•°ã€‚æ³¨æ„ï¼Œç»“æœè¢«æˆªæ–­åˆ°ç›®æ ‡æ“ä½œæ•°çš„å¤§å°ã€‚\n">
<title>ã€æ­¦å¤§è½¯ä»¶é€†å‘è¯¾ç¨‹/ç¬¬å››å‘¨ã€‘åŠ å‡ä¹˜é™¤è¿ç®—çš„é€†å‘ç‰¹å¾</title>

<link rel='canonical' href='https://xingfend.github.io/xingfen-star.github.io/post/reverse-program-course-week4/'>

<link rel="stylesheet" href="/xingfen-star.github.io/scss/style.min.c0fa910106829adb3edb67524eba5dffc21500fdd220ea53e6ba412a6f0ce2fe.css"><meta property='og:title' content="ã€æ­¦å¤§è½¯ä»¶é€†å‘è¯¾ç¨‹/ç¬¬å››å‘¨ã€‘åŠ å‡ä¹˜é™¤è¿ç®—çš„é€†å‘ç‰¹å¾">
<meta property='og:description' content="æ±‡ç¼–è¯­è¨€é¢„å¤‡çŸ¥è¯† æŒ‡ä»¤ç®€ä»‹ä¸æ€»è§ˆ æ±‡ç¼–æŒ‡ä»¤ æŒ‡ä»¤æ ¼å¼ åŠŸèƒ½ å¤‡æ³¨ lea lea reg, addr ä¸»è¦ç”¨äºå°†ä¸€ä¸ªå†…å­˜åœ°å€åŠ è½½åˆ°å¯„å­˜å™¨ä¸­ï¼Œ\nè€Œä¸æ˜¯å°†è¯¥åœ°å€å¤„çš„æ•°æ®åŠ è½½åˆ°å¯„å­˜å™¨ã€‚ å¦‚åœ¨printfå‡½æ•°ä¸­ï¼Œå°†æ ¼å¼å­—ç¬¦ä¸²çš„åœ°å€åŠ è½½åˆ°æŒ‡å®šå¯„å­˜å™¨ä¸­ä¾›printfå‡½æ•°è¯»å–ã€‚ inc inc reg å¯„å­˜å™¨è‡ªå¢1 å˜é‡åŠ ä¸€ mov mov reg, imm å°†ç«‹å³æ•°èµ‹å€¼åˆ°å¯„å­˜å™¨ä¸­ immæ„ä¸ºç«‹å³æ•°(immediate number) imul æŒ‡ä»¤æ ¼å¼è§è¯¦è§£ ç”¨äºæ‰§è¡Œå¸¦ç¬¦å·æ•´æ•°ä¹˜æ³•ã€‚ å®ƒå¯ä»¥æ¥å—ä¸€ä¸ªã€ä¸¤ä¸ªæˆ–ä¸‰ä¸ªæ“ä½œæ•°ï¼Œå…·ä½“å–å†³äºä½ æƒ³è¦æ‰§è¡Œçš„ä¹˜æ³•ç±»å‹ã€‚ mul mul source ç”¨äºæ‰§è¡Œæ— ç¬¦å·æ•´æ•°ä¹˜æ³•ã€‚ mul æŒ‡ä»¤åªæ¥å—ä¸€ä¸ªæ“ä½œæ•°ï¼Œè¿™ä¸ªæ“ä½œæ•°å¯ä»¥æ˜¯å¯„å­˜å™¨æˆ–å†…å­˜åœ°å€ã€‚æ ¹æ®æ“ä½œæ•°çš„å¤§å°ï¼ˆ8ä½ã€16ä½ã€32ä½æˆ–64ä½ï¼‰ï¼Œä¹˜ç§¯ä¼šè¢«å­˜å‚¨åœ¨ç‰¹å®šçš„å¯„å­˜å™¨ç»„åˆä¸­ã€‚ shl/shr shl/shr dest, cnt é€»è¾‘å·¦/å³ç§» shrç”¨äºå°†å¯„å­˜å™¨æˆ–å†…å­˜ä¸­çš„äºŒè¿›åˆ¶æ•°å€¼å‘å³ç§»åŠ¨æŒ‡å®šçš„ä½æ•°ã€‚è¿™ä¸ªæ“ä½œä¼šå°†æ¯ä¸ªä½éƒ½å‘å³ç§»åŠ¨ï¼Œå¹¶åœ¨å·¦ä¾§è¡¥0ã€‚å¯¹äºæ— ç¬¦å·æ•°æ¥è¯´ï¼Œè¿™ç›¸å½“äºé™¤ä»¥2çš„å¹‚æ¬¡ï¼›è€Œå¯¹äºæœ‰ç¬¦å·æ•°ï¼Œå®ƒä»…å½“è¢«ç§»ä½çš„æ•°æ®è§†ä¸ºæ— ç¬¦å·æ—¶æœ‰æ•ˆï¼Œå› ä¸ºé€»è¾‘å³ç§»ä¸ä¼šå¤åˆ¶ç¬¦å·ä½ã€‚ sar sar dest, count ç®—æœ¯å·¦/å³ç§» saræŒ‡ä»¤ç”¨äºå°†æŒ‡å®šçš„äºŒè¿›åˆ¶æ•°æŒ‰ç®—æœ¯å³ç§»çš„æ–¹å¼ç§»åŠ¨æŒ‡å®šçš„ä½æ•°ã€‚ç®—æœ¯å³ç§»æ˜¯æŒ‡åœ¨å³ç§»æ—¶ï¼Œæœ€é«˜ä½ï¼ˆç¬¦å·ä½ï¼‰ä¿æŒä¸å˜ï¼Œä½ä½ç§»å‡ºï¼Œé«˜ä½è¡¥ä¸Šç¬¦å·ä½çš„å€¼ã€‚è¿™é€šå¸¸ç”¨äºæœ‰ç¬¦å·æ•°çš„é™¤ä»¥2çš„å¹‚æ¬¡æ“ä½œã€‚ cdq cdq å°†32ä½å¯„å­˜å™¨eaxä¸­çš„æœ‰ç¬¦å·æ•°ç¬¦å·æ‰©å±•ä¸º64ä½ï¼Œç»“æœå­˜å‚¨åœ¨ç”±edx:eaxç»„æˆçš„64ä½å¯„å­˜å™¨ä¸­ å®ƒä¼šæŠŠeaxçš„ç¬¬31ä½ï¼ˆç¬¦å·ä½ï¼‰å¤åˆ¶åˆ°edxçš„æ¯ä¸€ä½ã€‚å¦‚æœeaxçš„ç¬¦å·ä½æ˜¯0ï¼ˆå³æ­£æ•°ï¼‰ï¼Œåˆ™edxä¼šè¢«è®¾ç½®ä¸º0ï¼›å¦‚æœç¬¦å·ä½æ˜¯1ï¼ˆå³è´Ÿæ•°ï¼‰ï¼Œåˆ™edxä¼šè¢«è®¾ç½®ä¸ºå…¨1ã€‚\né€šå¸¸åœ¨æ‰§è¡Œ32ä½æœ‰ç¬¦å·é™¤æ³•ï¼ˆå¦‚idivæŒ‡ä»¤ï¼‰ä¹‹å‰ä½¿ç”¨ï¼Œä»¥ç¡®ä¿è¢«é™¤æ•°çš„ç¬¦å·ä½æ­£ç¡®æ‰©å±•åˆ°é«˜ä½å¯„å­˜å™¨ï¼Œä»è€Œä¿è¯é™¤æ³•è¿ç®—çš„æ­£ç¡®æ€§ã€‚ cqo cqo å°†64ä½å¯„å­˜å™¨raxä¸­çš„æœ‰ç¬¦å·æ•°ç¬¦å·æ‰©å±•ä¸º128ä½ï¼Œç»“æœå­˜å‚¨åœ¨ç”±rdx:raxç»„æˆçš„128ä½å¯„å­˜å™¨ä¸­ å®ƒä¼šæŠŠraxçš„ç¬¬63ä½ï¼ˆç¬¦å·ä½ï¼‰å¤åˆ¶åˆ°rdxçš„æ¯ä¸€ä½ã€‚å¦‚æœraxçš„ç¬¦å·ä½æ˜¯0ï¼Œåˆ™rdxè¢«è®¾ç½®ä¸º0ï¼›å¦‚æœç¬¦å·ä½æ˜¯1ï¼Œåˆ™rdxè¢«è®¾ç½®ä¸ºå…¨1ã€‚\nåœ¨64ä½æ¨¡å¼ä¸‹ï¼Œé€šå¸¸åœ¨æ‰§è¡Œ64ä½æœ‰ç¬¦å·é™¤æ³•ä¹‹å‰ä½¿ç”¨ï¼Œç¡®ä¿è¢«é™¤æ•°çš„ç¬¦å·ä½æ­£ç¡®æ‰©å±•åˆ°é«˜ä½å¯„å­˜å™¨ã€‚ imul - å¸¦ç¬¦å·æ•´æ•°ä¹˜æ³• ä¸€ä¸ªæ“ä½œæ•° imul src \u200b\tè¿™ç§å½¢å¼å‡è®¾éšå«çš„ç›®æ ‡æ“ä½œæ•°æ˜¯ç´¯åŠ å™¨ï¼ˆå¯¹äº16ä½æ“ä½œä¸ºAXï¼Œå¯¹äº32ä½æ“ä½œä¸ºEAXï¼Œå¯¹äº64ä½æ“ä½œä¸ºRAXï¼‰ã€‚è¯¥æŒ‡ä»¤å°†ç´¯åŠ å™¨ä¸sourceç›¸ä¹˜ï¼Œå¹¶å°†ç»“æœå­˜å‚¨å›ç´¯åŠ å™¨å’Œå…¶å¯¹åº”çš„åŒå€å®½åº¦å¯„å­˜å™¨ï¼ˆå³å¯¹äº16ä½æ“ä½œä¸ºDX:AXï¼Œå¯¹äº32ä½æ“ä½œä¸ºEDX:EAXï¼Œå¯¹äº64ä½æ“ä½œä¸ºRDX:RAXï¼‰ã€‚\nä¸¤ä¸ªæ“ä½œæ•° imul dest, source \u200b\tè¿™ç§å½¢å¼å°†sourceä¸destç›¸ä¹˜ï¼Œå¹¶å°†ç»“æœå­˜å‚¨åœ¨destä¸­ã€‚destå¯ä»¥æ˜¯ä¸€ä¸ªå¯„å­˜å™¨æˆ–å†…å­˜ä½ç½®ï¼Œè€Œsourceå¯ä»¥æ˜¯ä¸€ä¸ªå¯„å­˜å™¨ã€å†…å­˜ä½ç½®æˆ–ç«‹å³æ•°ã€‚æ³¨æ„ï¼Œç»“æœè¢«æˆªæ–­åˆ°ç›®æ ‡æ“ä½œæ•°çš„å¤§å°ã€‚\n">
<meta property='og:url' content='https://xingfend.github.io/xingfen-star.github.io/post/reverse-program-course-week4/'>
<meta property='og:site_name' content='è¿œæ¥’'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='è½¯ä»¶é€†å‘' /><meta property='article:published_time' content='2025-03-15T06:27:52&#43;00:00'/><meta property='article:modified_time' content='2025-03-17T05:30:28&#43;00:00'/>
<meta name="twitter:title" content="ã€æ­¦å¤§è½¯ä»¶é€†å‘è¯¾ç¨‹/ç¬¬å››å‘¨ã€‘åŠ å‡ä¹˜é™¤è¿ç®—çš„é€†å‘ç‰¹å¾">
<meta name="twitter:description" content="æ±‡ç¼–è¯­è¨€é¢„å¤‡çŸ¥è¯† æŒ‡ä»¤ç®€ä»‹ä¸æ€»è§ˆ æ±‡ç¼–æŒ‡ä»¤ æŒ‡ä»¤æ ¼å¼ åŠŸèƒ½ å¤‡æ³¨ lea lea reg, addr ä¸»è¦ç”¨äºå°†ä¸€ä¸ªå†…å­˜åœ°å€åŠ è½½åˆ°å¯„å­˜å™¨ä¸­ï¼Œ\nè€Œä¸æ˜¯å°†è¯¥åœ°å€å¤„çš„æ•°æ®åŠ è½½åˆ°å¯„å­˜å™¨ã€‚ å¦‚åœ¨printfå‡½æ•°ä¸­ï¼Œå°†æ ¼å¼å­—ç¬¦ä¸²çš„åœ°å€åŠ è½½åˆ°æŒ‡å®šå¯„å­˜å™¨ä¸­ä¾›printfå‡½æ•°è¯»å–ã€‚ inc inc reg å¯„å­˜å™¨è‡ªå¢1 å˜é‡åŠ ä¸€ mov mov reg, imm å°†ç«‹å³æ•°èµ‹å€¼åˆ°å¯„å­˜å™¨ä¸­ immæ„ä¸ºç«‹å³æ•°(immediate number) imul æŒ‡ä»¤æ ¼å¼è§è¯¦è§£ ç”¨äºæ‰§è¡Œå¸¦ç¬¦å·æ•´æ•°ä¹˜æ³•ã€‚ å®ƒå¯ä»¥æ¥å—ä¸€ä¸ªã€ä¸¤ä¸ªæˆ–ä¸‰ä¸ªæ“ä½œæ•°ï¼Œå…·ä½“å–å†³äºä½ æƒ³è¦æ‰§è¡Œçš„ä¹˜æ³•ç±»å‹ã€‚ mul mul source ç”¨äºæ‰§è¡Œæ— ç¬¦å·æ•´æ•°ä¹˜æ³•ã€‚ mul æŒ‡ä»¤åªæ¥å—ä¸€ä¸ªæ“ä½œæ•°ï¼Œè¿™ä¸ªæ“ä½œæ•°å¯ä»¥æ˜¯å¯„å­˜å™¨æˆ–å†…å­˜åœ°å€ã€‚æ ¹æ®æ“ä½œæ•°çš„å¤§å°ï¼ˆ8ä½ã€16ä½ã€32ä½æˆ–64ä½ï¼‰ï¼Œä¹˜ç§¯ä¼šè¢«å­˜å‚¨åœ¨ç‰¹å®šçš„å¯„å­˜å™¨ç»„åˆä¸­ã€‚ shl/shr shl/shr dest, cnt é€»è¾‘å·¦/å³ç§» shrç”¨äºå°†å¯„å­˜å™¨æˆ–å†…å­˜ä¸­çš„äºŒè¿›åˆ¶æ•°å€¼å‘å³ç§»åŠ¨æŒ‡å®šçš„ä½æ•°ã€‚è¿™ä¸ªæ“ä½œä¼šå°†æ¯ä¸ªä½éƒ½å‘å³ç§»åŠ¨ï¼Œå¹¶åœ¨å·¦ä¾§è¡¥0ã€‚å¯¹äºæ— ç¬¦å·æ•°æ¥è¯´ï¼Œè¿™ç›¸å½“äºé™¤ä»¥2çš„å¹‚æ¬¡ï¼›è€Œå¯¹äºæœ‰ç¬¦å·æ•°ï¼Œå®ƒä»…å½“è¢«ç§»ä½çš„æ•°æ®è§†ä¸ºæ— ç¬¦å·æ—¶æœ‰æ•ˆï¼Œå› ä¸ºé€»è¾‘å³ç§»ä¸ä¼šå¤åˆ¶ç¬¦å·ä½ã€‚ sar sar dest, count ç®—æœ¯å·¦/å³ç§» saræŒ‡ä»¤ç”¨äºå°†æŒ‡å®šçš„äºŒè¿›åˆ¶æ•°æŒ‰ç®—æœ¯å³ç§»çš„æ–¹å¼ç§»åŠ¨æŒ‡å®šçš„ä½æ•°ã€‚ç®—æœ¯å³ç§»æ˜¯æŒ‡åœ¨å³ç§»æ—¶ï¼Œæœ€é«˜ä½ï¼ˆç¬¦å·ä½ï¼‰ä¿æŒä¸å˜ï¼Œä½ä½ç§»å‡ºï¼Œé«˜ä½è¡¥ä¸Šç¬¦å·ä½çš„å€¼ã€‚è¿™é€šå¸¸ç”¨äºæœ‰ç¬¦å·æ•°çš„é™¤ä»¥2çš„å¹‚æ¬¡æ“ä½œã€‚ cdq cdq å°†32ä½å¯„å­˜å™¨eaxä¸­çš„æœ‰ç¬¦å·æ•°ç¬¦å·æ‰©å±•ä¸º64ä½ï¼Œç»“æœå­˜å‚¨åœ¨ç”±edx:eaxç»„æˆçš„64ä½å¯„å­˜å™¨ä¸­ å®ƒä¼šæŠŠeaxçš„ç¬¬31ä½ï¼ˆç¬¦å·ä½ï¼‰å¤åˆ¶åˆ°edxçš„æ¯ä¸€ä½ã€‚å¦‚æœeaxçš„ç¬¦å·ä½æ˜¯0ï¼ˆå³æ­£æ•°ï¼‰ï¼Œåˆ™edxä¼šè¢«è®¾ç½®ä¸º0ï¼›å¦‚æœç¬¦å·ä½æ˜¯1ï¼ˆå³è´Ÿæ•°ï¼‰ï¼Œåˆ™edxä¼šè¢«è®¾ç½®ä¸ºå…¨1ã€‚\né€šå¸¸åœ¨æ‰§è¡Œ32ä½æœ‰ç¬¦å·é™¤æ³•ï¼ˆå¦‚idivæŒ‡ä»¤ï¼‰ä¹‹å‰ä½¿ç”¨ï¼Œä»¥ç¡®ä¿è¢«é™¤æ•°çš„ç¬¦å·ä½æ­£ç¡®æ‰©å±•åˆ°é«˜ä½å¯„å­˜å™¨ï¼Œä»è€Œä¿è¯é™¤æ³•è¿ç®—çš„æ­£ç¡®æ€§ã€‚ cqo cqo å°†64ä½å¯„å­˜å™¨raxä¸­çš„æœ‰ç¬¦å·æ•°ç¬¦å·æ‰©å±•ä¸º128ä½ï¼Œç»“æœå­˜å‚¨åœ¨ç”±rdx:raxç»„æˆçš„128ä½å¯„å­˜å™¨ä¸­ å®ƒä¼šæŠŠraxçš„ç¬¬63ä½ï¼ˆç¬¦å·ä½ï¼‰å¤åˆ¶åˆ°rdxçš„æ¯ä¸€ä½ã€‚å¦‚æœraxçš„ç¬¦å·ä½æ˜¯0ï¼Œåˆ™rdxè¢«è®¾ç½®ä¸º0ï¼›å¦‚æœç¬¦å·ä½æ˜¯1ï¼Œåˆ™rdxè¢«è®¾ç½®ä¸ºå…¨1ã€‚\nåœ¨64ä½æ¨¡å¼ä¸‹ï¼Œé€šå¸¸åœ¨æ‰§è¡Œ64ä½æœ‰ç¬¦å·é™¤æ³•ä¹‹å‰ä½¿ç”¨ï¼Œç¡®ä¿è¢«é™¤æ•°çš„ç¬¦å·ä½æ­£ç¡®æ‰©å±•åˆ°é«˜ä½å¯„å­˜å™¨ã€‚ imul - å¸¦ç¬¦å·æ•´æ•°ä¹˜æ³• ä¸€ä¸ªæ“ä½œæ•° imul src \u200b\tè¿™ç§å½¢å¼å‡è®¾éšå«çš„ç›®æ ‡æ“ä½œæ•°æ˜¯ç´¯åŠ å™¨ï¼ˆå¯¹äº16ä½æ“ä½œä¸ºAXï¼Œå¯¹äº32ä½æ“ä½œä¸ºEAXï¼Œå¯¹äº64ä½æ“ä½œä¸ºRAXï¼‰ã€‚è¯¥æŒ‡ä»¤å°†ç´¯åŠ å™¨ä¸sourceç›¸ä¹˜ï¼Œå¹¶å°†ç»“æœå­˜å‚¨å›ç´¯åŠ å™¨å’Œå…¶å¯¹åº”çš„åŒå€å®½åº¦å¯„å­˜å™¨ï¼ˆå³å¯¹äº16ä½æ“ä½œä¸ºDX:AXï¼Œå¯¹äº32ä½æ“ä½œä¸ºEDX:EAXï¼Œå¯¹äº64ä½æ“ä½œä¸ºRDX:RAXï¼‰ã€‚\nä¸¤ä¸ªæ“ä½œæ•° imul dest, source \u200b\tè¿™ç§å½¢å¼å°†sourceä¸destç›¸ä¹˜ï¼Œå¹¶å°†ç»“æœå­˜å‚¨åœ¨destä¸­ã€‚destå¯ä»¥æ˜¯ä¸€ä¸ªå¯„å­˜å™¨æˆ–å†…å­˜ä½ç½®ï¼Œè€Œsourceå¯ä»¥æ˜¯ä¸€ä¸ªå¯„å­˜å™¨ã€å†…å­˜ä½ç½®æˆ–ç«‹å³æ•°ã€‚æ³¨æ„ï¼Œç»“æœè¢«æˆªæ–­åˆ°ç›®æ ‡æ“ä½œæ•°çš„å¤§å°ã€‚\n">
    <link rel="shortcut icon" href="/xingfen-star.github.io/favicon.ico" />

    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="Toggle Menu">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/xingfen-star.github.io/">
                
                    

                    
                        
                        <img src="/xingfen-star.github.io/img/avatar_hu_e75ba5eda9add5a4.png" width="300"
                            height="279" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
                    <span class="emoji">ğŸ˜‰</span>
                
            </figure>
            
        

        <div class="site-meta">
            <h1 class="site-name"><a href="/xingfen-star.github.io">è¿œæ¥’</a></h1>
            <h2 class="site-description">æ˜Ÿåˆ†.</h2>
        </div>
    </header><ol class="menu-social">
            
                <li>
                    <a
                        href='https://space.bilibili.com/473214036'
                        target="_blank"
                        title="Bilibili"
                        rel="me"
                    >
                        
                        
                            <svg class="icon" style="width: 24;height: 24;vertical-align: middle;fill: currentColor;overflow: hidden;" viewBox="0 0 2299 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1461"><path d="M1775.840814 322.588002c6.0164 1.002733 53.144869-9.525967 55.150336-6.016401 3.0082 4.5123 24.065601 155.92504 18.550567 156.927774s-44.621635 10.027334-44.621635 10.027334c-3.0082-20.556034-28.577901-147.903173-29.079268-160.938707m75.205003-14.539634l20.556034 162.944174c10.5287-0.501367 53.144869-3.509567 57.155803-4.010934-6.0164-61.668103-16.545101-158.933241-16.545101-158.93324-20.054668-4.010934-41.112069-4.010934-61.166736 0m-40.610702 226.116376s92.752838-23.564234 126.344406-12.0328c17.046467 61.668103 48.131202 407.611118 51.139402 421.649386-21.057401 2.506833-90.246004 8.523234-95.761037 10.027333-4.5123-26.071068-81.72277-403.098818-81.722771-419.643919m343.436183-207.565809c5.515034 1.5041 54.648969-5.013667 55.150335-1.5041 1.002733 12.032801 6.0164 157.42914 0.501367 157.930507s-44.621635 4.010934-44.621635 4.010934c-1.002733-20.054668-12.032801-146.90044-11.030067-160.437341m75.70637-4.010933l4.010933 160.938707c10.5287 0 52.643502 2.506833 57.155803 2.005467-1.002733-61.668103 0-158.933241 0-158.933241-20.054668-3.509567-40.610702-5.013667-61.166736-4.010933m-64.676303 216.089043s94.758304-12.534167 126.845772 2.506833c7.019134 72.196803 6.0164 408.613852 7.019134 422.652119-21.558768 0-90.246004 1.002733-95.761038 2.005467-1.002733-26.071068-39.607968-410.619319-38.103868-427.164419m-220.099977-413.627519c54.648969 278.759879 96.262404 755.058234 97.766504 785.641602 0 0 43.117535 1.002733 91.750105 4.010934C2105.740095 614.383415 2070.644427 134.575493 2071.145794 119.033126c-12.032801-13.536901-126.344406 6.0164-126.344406 6.0164m-120.328005 659.297196c-10.5287-78.213204-290.291313-166.955108-447.720454-138.377206 0 0-19.553301-172.470141-27.073801-339.425248-6.517767-143.390873-1.002733-282.770813 0.501366-305.833681-10.5287-7.5205-123.837572 46.627102-185.004308 69.188603 0 0 73.199537 309.844614 126.344406 952.59671 0 0 84.730971 9.0246 230.12731-19.051934s317.365114-115.815705 302.825481-219.097244m-341.932083 140.88404l-24.566967-176.982441c6.0164-3.0082 156.927774 53.144869 172.971507 63.172203-2.506833 11.030067-148.40454 113.810238-148.40454 113.810238M610.664628 322.588002c6.0164 1.002733 53.144869-9.525967 55.150335-6.016401 3.0082 4.5123 24.065601 155.92504 18.550568 156.927774s-44.621635 10.027334-44.621635 10.027334c-3.0082-20.556034-28.577901-147.903173-29.079268-160.938707m75.205003-14.539634l20.556034 162.944174c10.5287-0.501367 53.144869-3.509567 57.155803-4.010934-6.517767-61.668103-16.545101-158.933241-16.545101-158.93324-20.054668-4.010934-41.112069-4.010934-61.166736 0m-40.610702 226.116376s92.752838-23.564234 126.344406-12.0328c17.046467 61.668103 48.131202 407.611118 51.139402 421.649386-21.057401 2.506833-90.246004 8.523234-95.761037 10.027333-4.5123-26.071068-81.72277-403.098818-81.722771-419.643919m343.436182-207.565809c5.515034 1.5041 54.648969-5.013667 55.150336-1.5041 1.002733 12.032801 6.0164 157.42914 0.501367 157.930507s-44.621635 4.010934-44.621635 4.010934c-1.002733-20.054668-11.531434-146.90044-11.030068-160.437341m75.706371-4.010933l4.010933 160.938707c10.5287 0 52.643502 2.506833 57.155803 2.005467-1.002733-61.668103 0-158.933241 0-158.933241-20.054668-3.509567-40.610702-4.5123-61.166736-4.010933m-64.676303 216.089043s94.758304-12.534167 126.845772 2.506833c7.019134 72.196803 6.0164 408.613852 7.019134 422.652119-21.558768 0-90.246004 1.002733-95.761038 2.005467-0.501367-26.071068-39.607968-410.619319-38.103868-427.164419m-220.099977-413.627519c54.648969 278.759879 96.262404 755.058234 97.766504 785.641602 0 0 43.117535 1.002733 91.750105 4.010934-28.577901-300.318647-63.67357-780.126569-63.172203-796.170303-12.032801-13.035534-126.344406 6.517767-126.344406 6.517767m-120.328005 659.297196c-10.5287-78.213204-290.291313-166.955108-447.720454-138.377206 0 0-19.553301-172.470141-27.073801-339.425248-6.517767-143.390873-1.002733-282.770813 0.501366-305.833681C174.475608-6.308547 61.166736 47.337689 0 69.89919c0 0 73.199537 309.844614 126.344406 952.59671 0 0 84.730971 9.0246 230.12731-19.051934s317.365114-115.815705 302.825481-219.097244m-341.932083 140.88404l-24.566967-176.982441c6.0164-3.0082 156.927774 53.144869 172.971507 63.172203-2.506833 11.030067-148.40454 113.810238-148.40454 113.810238" p-id="1462"></path></svg>
                        
                    </a>
                </li>
            
                <li>
                    <a
                        href='https://github.com/xingfend'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <?xml version="1.0" encoding="UTF-8"?><svg width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M29.3444 30.4765C31.7481 29.977 33.9292 29.1108 35.6247 27.8391C38.5202 25.6676 40 22.3136 40 18.9999C40 16.6752 39.1187 14.505 37.5929 12.6668C36.7427 11.6425 39.2295 3.99989 37.02 5.02919C34.8105 6.05848 31.5708 8.33679 29.8726 7.83398C28.0545 7.29565 26.0733 6.99989 24 6.99989C22.1992 6.99989 20.4679 7.22301 18.8526 7.6344C16.5046 8.23237 14.2591 5.99989 12 5.02919C9.74086 4.05848 10.9736 11.9632 10.3026 12.7944C8.84119 14.6051 8 16.7288 8 18.9999C8 22.3136 9.79086 25.6676 12.6863 27.8391C14.6151 29.2857 17.034 30.2076 19.7401 30.6619" stroke="#707070" stroke-width="4" stroke-linecap="round"/><path d="M19.7397 30.6619C18.5812 31.937 18.002 33.1478 18.002 34.2944C18.002 35.441 18.002 38.3464 18.002 43.0106" stroke="#707070" stroke-width="4" stroke-linecap="round"/><path d="M29.3446 30.4766C30.4423 31.9174 30.9912 33.211 30.9912 34.3576C30.9912 35.5042 30.9912 38.3885 30.9912 43.0107" stroke="#707070" stroke-width="4" stroke-linecap="round"/><path d="M6 31.2155C6.89887 31.3254 7.56554 31.7387 8 32.4554C8.65169 33.5303 11.0742 37.518 13.8251 37.518C15.6591 37.518 17.0515 37.518 18.0024 37.518" stroke="#707070" stroke-width="4" stroke-linecap="round"/></svg>
                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/xingfen-star.github.io/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>ä¸»é¡µ</span>
            </a>
        </li>
        
        
        <li >
            <a href='/xingfen-star.github.io/page/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>å½’æ¡£</span>
            </a>
        </li>
        
        
        <li >
            <a href='/xingfen-star.github.io/page/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>æœç´¢</span>
            </a>
        </li>
        
        
        <li >
            <a href='/xingfen-star.github.io/page/about/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>å…³äº</span>
            </a>
        </li>
        
        
        <li >
            <a href='/xingfen-star.github.io/page/links/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5" />
  <path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5" />
</svg>



                
                <span>é“¾æ¥</span>
            </a>
        </li>
        
        <li class="menu-bottom-section">
            <ol class="menu">

                
                    <li id="dark-mode-toggle">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <span>Dark Mode</span>
                    </li>
                
                
            </ol>
        </li>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">Table of contents</h2>

        <div class="widget--toc">
            <nav id="TableOfContents">
  <ul>
    <li><a href="#æ±‡ç¼–è¯­è¨€é¢„å¤‡çŸ¥è¯†">æ±‡ç¼–è¯­è¨€é¢„å¤‡çŸ¥è¯†</a>
      <ul>
        <li><a href="#æŒ‡ä»¤ç®€ä»‹ä¸æ€»è§ˆ">æŒ‡ä»¤ç®€ä»‹ä¸æ€»è§ˆ</a></li>
        <li><a href="#imul---å¸¦ç¬¦å·æ•´æ•°ä¹˜æ³•">imul - å¸¦ç¬¦å·æ•´æ•°ä¹˜æ³•</a></li>
        <li><a href="#mul---æ— ç¬¦å·æ•´æ•°ä¹˜æ³•">mul - æ— ç¬¦å·æ•´æ•°ä¹˜æ³•</a></li>
        <li><a href="#scanfä¸printfå‡½æ•°">scanfä¸printfå‡½æ•°</a></li>
      </ul>
    </li>
    <li><a href="#é€†å‘åˆ†æç¨‹åº1">é€†å‘åˆ†æç¨‹åº1</a></li>
    <li><a href="#é€†å‘åˆ†æç¨‹åº2">é€†å‘åˆ†æç¨‹åº2</a></li>
  </ul>
</nav>
        </div>
    </section>

            
        
            
                
<section class="widget curTags">
    <div class="widget-icon">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-tag" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11 3L20 12a1.5 1.5 0 0 1 0 2L14 20a1.5 1.5 0 0 1 -2 0L3 11v-4a4 4 0 0 1 4 -4h4" />
  <circle cx="9" cy="9" r="2" />
</svg>



    </div>
    <h2 class="widget-title section-title">Tags of current blog</h2>
    <div class="curTags-tags">
        
            <a href="/xingfen-star.github.io/tags/%E8%BD%AF%E4%BB%B6%E9%80%86%E5%90%91/">
                è½¯ä»¶é€†å‘
            </a>
        
    </div>
</section>

            
        
    </aside>


            <main class="main full-width">
    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/xingfen-star.github.io/categories/course/" style="background-color: #2a9d8f; color: #fff;">
                è¯¾ç¨‹ä½œä¸š
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/xingfen-star.github.io/post/reverse-program-course-week4/">ã€æ­¦å¤§è½¯ä»¶é€†å‘è¯¾ç¨‹/ç¬¬å››å‘¨ã€‘åŠ å‡ä¹˜é™¤è¿ç®—çš„é€†å‘ç‰¹å¾</a>
        </h2>

        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Mar 15, 2025</time>
            </div>
        

        
        <div class="article-lastmod">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time>
                    Mar 17, 2025 05:30 UTC
                </time>
            </div>
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    6 minute read
                </time>
            </div>
        

    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <h2 id="æ±‡ç¼–è¯­è¨€é¢„å¤‡çŸ¥è¯†">æ±‡ç¼–è¯­è¨€é¢„å¤‡çŸ¥è¯†
</h2><h3 id="æŒ‡ä»¤ç®€ä»‹ä¸æ€»è§ˆ">æŒ‡ä»¤ç®€ä»‹ä¸æ€»è§ˆ
</h3><div class="table-wrapper"><table>
  <thead>
      <tr>
          <th style="text-align: center">æ±‡ç¼–æŒ‡ä»¤</th>
          <th>æŒ‡ä»¤æ ¼å¼</th>
          <th>åŠŸèƒ½</th>
          <th>å¤‡æ³¨</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: center">lea</td>
          <td><code>lea reg, addr</code></td>
          <td>ä¸»è¦ç”¨äºå°†ä¸€ä¸ªå†…å­˜åœ°å€åŠ è½½åˆ°å¯„å­˜å™¨ä¸­ï¼Œ<br />è€Œä¸æ˜¯å°†è¯¥åœ°å€å¤„çš„æ•°æ®åŠ è½½åˆ°å¯„å­˜å™¨ã€‚</td>
          <td>å¦‚åœ¨<code>printf</code>å‡½æ•°ä¸­ï¼Œå°†æ ¼å¼å­—ç¬¦ä¸²çš„åœ°å€åŠ è½½åˆ°æŒ‡å®šå¯„å­˜å™¨ä¸­ä¾›<code>printf</code>å‡½æ•°è¯»å–ã€‚</td>
      </tr>
      <tr>
          <td style="text-align: center">inc</td>
          <td><code>inc reg</code></td>
          <td>å¯„å­˜å™¨è‡ªå¢1</td>
          <td>å˜é‡åŠ ä¸€</td>
      </tr>
      <tr>
          <td style="text-align: center">mov</td>
          <td><code>mov reg, imm</code></td>
          <td>å°†ç«‹å³æ•°èµ‹å€¼åˆ°å¯„å­˜å™¨ä¸­</td>
          <td><code>imm</code>æ„ä¸ºç«‹å³æ•°(immediate number)</td>
      </tr>
      <tr>
          <td style="text-align: center">imul</td>
          <td>æŒ‡ä»¤æ ¼å¼è§è¯¦è§£</td>
          <td>ç”¨äºæ‰§è¡Œå¸¦ç¬¦å·æ•´æ•°ä¹˜æ³•ã€‚</td>
          <td>å®ƒå¯ä»¥æ¥å—ä¸€ä¸ªã€ä¸¤ä¸ªæˆ–ä¸‰ä¸ªæ“ä½œæ•°ï¼Œå…·ä½“å–å†³äºä½ æƒ³è¦æ‰§è¡Œçš„ä¹˜æ³•ç±»å‹ã€‚</td>
      </tr>
      <tr>
          <td style="text-align: center">mul</td>
          <td><code>mul source</code></td>
          <td>ç”¨äºæ‰§è¡Œæ— ç¬¦å·æ•´æ•°ä¹˜æ³•ã€‚</td>
          <td><code>mul</code> æŒ‡ä»¤åªæ¥å—ä¸€ä¸ªæ“ä½œæ•°ï¼Œè¿™ä¸ªæ“ä½œæ•°å¯ä»¥æ˜¯å¯„å­˜å™¨æˆ–å†…å­˜åœ°å€ã€‚æ ¹æ®æ“ä½œæ•°çš„å¤§å°ï¼ˆ8ä½ã€16ä½ã€32ä½æˆ–64ä½ï¼‰ï¼Œä¹˜ç§¯ä¼šè¢«å­˜å‚¨åœ¨ç‰¹å®šçš„å¯„å­˜å™¨ç»„åˆä¸­ã€‚</td>
      </tr>
      <tr>
          <td style="text-align: center">shl/shr</td>
          <td><code>shl/shr dest, cnt</code></td>
          <td>é€»è¾‘å·¦/å³ç§»</td>
          <td><code>shr</code>ç”¨äºå°†å¯„å­˜å™¨æˆ–å†…å­˜ä¸­çš„äºŒè¿›åˆ¶æ•°å€¼å‘å³ç§»åŠ¨æŒ‡å®šçš„ä½æ•°ã€‚è¿™ä¸ªæ“ä½œä¼šå°†æ¯ä¸ªä½éƒ½å‘å³ç§»åŠ¨ï¼Œå¹¶åœ¨å·¦ä¾§è¡¥0ã€‚å¯¹äºæ— ç¬¦å·æ•°æ¥è¯´ï¼Œè¿™ç›¸å½“äºé™¤ä»¥2çš„å¹‚æ¬¡ï¼›è€Œå¯¹äºæœ‰ç¬¦å·æ•°ï¼Œå®ƒä»…å½“è¢«ç§»ä½çš„æ•°æ®è§†ä¸ºæ— ç¬¦å·æ—¶æœ‰æ•ˆï¼Œå› ä¸ºé€»è¾‘å³ç§»ä¸ä¼šå¤åˆ¶ç¬¦å·ä½ã€‚</td>
      </tr>
      <tr>
          <td style="text-align: center">sar</td>
          <td><code>sar dest, count</code></td>
          <td>ç®—æœ¯å·¦/å³ç§»</td>
          <td><code>sar</code>æŒ‡ä»¤ç”¨äºå°†æŒ‡å®šçš„äºŒè¿›åˆ¶æ•°æŒ‰ç®—æœ¯å³ç§»çš„æ–¹å¼ç§»åŠ¨æŒ‡å®šçš„ä½æ•°ã€‚ç®—æœ¯å³ç§»æ˜¯æŒ‡åœ¨å³ç§»æ—¶ï¼Œæœ€é«˜ä½ï¼ˆç¬¦å·ä½ï¼‰ä¿æŒä¸å˜ï¼Œä½ä½ç§»å‡ºï¼Œé«˜ä½è¡¥ä¸Šç¬¦å·ä½çš„å€¼ã€‚è¿™é€šå¸¸ç”¨äºæœ‰ç¬¦å·æ•°çš„é™¤ä»¥2çš„å¹‚æ¬¡æ“ä½œã€‚</td>
      </tr>
      <tr>
          <td style="text-align: center">cdq</td>
          <td><code>cdq</code></td>
          <td>å°†32ä½å¯„å­˜å™¨<code>eax</code>ä¸­çš„æœ‰ç¬¦å·æ•°ç¬¦å·æ‰©å±•ä¸º64ä½ï¼Œç»“æœå­˜å‚¨åœ¨ç”±<code>edx:eax</code>ç»„æˆçš„64ä½å¯„å­˜å™¨ä¸­</td>
          <td>å®ƒä¼šæŠŠ<code>eax</code>çš„ç¬¬31ä½ï¼ˆç¬¦å·ä½ï¼‰å¤åˆ¶åˆ°<code>edx</code>çš„æ¯ä¸€ä½ã€‚å¦‚æœ<code>eax</code>çš„ç¬¦å·ä½æ˜¯0ï¼ˆå³æ­£æ•°ï¼‰ï¼Œåˆ™<code>edx</code>ä¼šè¢«è®¾ç½®ä¸º0ï¼›å¦‚æœç¬¦å·ä½æ˜¯1ï¼ˆå³è´Ÿæ•°ï¼‰ï¼Œåˆ™<code>edx</code>ä¼šè¢«è®¾ç½®ä¸ºå…¨1ã€‚<br />é€šå¸¸åœ¨æ‰§è¡Œ32ä½æœ‰ç¬¦å·é™¤æ³•ï¼ˆå¦‚<code>idiv</code>æŒ‡ä»¤ï¼‰ä¹‹å‰ä½¿ç”¨ï¼Œä»¥ç¡®ä¿è¢«é™¤æ•°çš„ç¬¦å·ä½æ­£ç¡®æ‰©å±•åˆ°é«˜ä½å¯„å­˜å™¨ï¼Œä»è€Œä¿è¯é™¤æ³•è¿ç®—çš„æ­£ç¡®æ€§ã€‚</td>
      </tr>
      <tr>
          <td style="text-align: center">cqo</td>
          <td><code>cqo</code></td>
          <td>å°†64ä½å¯„å­˜å™¨<code>rax</code>ä¸­çš„æœ‰ç¬¦å·æ•°ç¬¦å·æ‰©å±•ä¸º128ä½ï¼Œç»“æœå­˜å‚¨åœ¨ç”±<code>rdx:rax</code>ç»„æˆçš„128ä½å¯„å­˜å™¨ä¸­</td>
          <td>å®ƒä¼šæŠŠ<code>rax</code>çš„ç¬¬63ä½ï¼ˆç¬¦å·ä½ï¼‰å¤åˆ¶åˆ°<code>rdx</code>çš„æ¯ä¸€ä½ã€‚å¦‚æœ<code>rax</code>çš„ç¬¦å·ä½æ˜¯0ï¼Œåˆ™<code>rdx</code>è¢«è®¾ç½®ä¸º0ï¼›å¦‚æœç¬¦å·ä½æ˜¯1ï¼Œåˆ™<code>rdx</code>è¢«è®¾ç½®ä¸ºå…¨1ã€‚<br />åœ¨64ä½æ¨¡å¼ä¸‹ï¼Œé€šå¸¸åœ¨æ‰§è¡Œ64ä½æœ‰ç¬¦å·é™¤æ³•ä¹‹å‰ä½¿ç”¨ï¼Œç¡®ä¿è¢«é™¤æ•°çš„ç¬¦å·ä½æ­£ç¡®æ‰©å±•åˆ°é«˜ä½å¯„å­˜å™¨ã€‚</td>
      </tr>
  </tbody>
</table></div>
<h3 id="imul---å¸¦ç¬¦å·æ•´æ•°ä¹˜æ³•">imul - å¸¦ç¬¦å·æ•´æ•°ä¹˜æ³•
</h3><h4 id="ä¸€ä¸ªæ“ä½œæ•°">ä¸€ä¸ªæ“ä½œæ•°
</h4><pre tabindex="0"><code class="language-assembly" data-lang="assembly">imul src
</code></pre><p>â€‹	è¿™ç§å½¢å¼å‡è®¾éšå«çš„ç›®æ ‡æ“ä½œæ•°æ˜¯ç´¯åŠ å™¨ï¼ˆå¯¹äº16ä½æ“ä½œä¸º<code>AX</code>ï¼Œå¯¹äº32ä½æ“ä½œä¸º<code>EAX</code>ï¼Œå¯¹äº64ä½æ“ä½œä¸º<code>RAX</code>ï¼‰ã€‚è¯¥æŒ‡ä»¤å°†ç´¯åŠ å™¨ä¸<code>source</code>ç›¸ä¹˜ï¼Œå¹¶å°†ç»“æœå­˜å‚¨å›ç´¯åŠ å™¨å’Œå…¶å¯¹åº”çš„åŒå€å®½åº¦å¯„å­˜å™¨ï¼ˆå³å¯¹äº16ä½æ“ä½œä¸º<code>DX:AX</code>ï¼Œå¯¹äº32ä½æ“ä½œä¸º<code>EDX:EAX</code>ï¼Œå¯¹äº64ä½æ“ä½œä¸º<code>RDX:RAX</code>ï¼‰ã€‚</p>
<h4 id="ä¸¤ä¸ªæ“ä½œæ•°">ä¸¤ä¸ªæ“ä½œæ•°
</h4><pre tabindex="0"><code class="language-assembly" data-lang="assembly">imul dest, source
</code></pre><p>â€‹	è¿™ç§å½¢å¼å°†<code>source</code>ä¸<code>dest</code>ç›¸ä¹˜ï¼Œå¹¶å°†ç»“æœå­˜å‚¨åœ¨<code>dest</code>ä¸­ã€‚<code>dest</code>å¯ä»¥æ˜¯ä¸€ä¸ªå¯„å­˜å™¨æˆ–å†…å­˜ä½ç½®ï¼Œè€Œ<code>source</code>å¯ä»¥æ˜¯ä¸€ä¸ªå¯„å­˜å™¨ã€å†…å­˜ä½ç½®æˆ–ç«‹å³æ•°ã€‚æ³¨æ„ï¼Œç»“æœè¢«æˆªæ–­åˆ°ç›®æ ‡æ“ä½œæ•°çš„å¤§å°ã€‚</p>
<h4 id="ä¸‰ä¸ªæ“ä½œæ•°">ä¸‰ä¸ªæ“ä½œæ•°
</h4><pre tabindex="0"><code class="language-assembly" data-lang="assembly">imul dest, source1, source2
</code></pre><p>â€‹	è¿™ç§å½¢å¼å°†<code>source1</code>ä¸<code>source2</code>ç›¸ä¹˜ï¼Œå¹¶å°†ç»“æœå­˜å‚¨åœ¨<code>dest</code>ä¸­ã€‚<code>source1</code>å’Œ<code>source2</code>å¯ä»¥æ˜¯å¯„å­˜å™¨ã€å†…å­˜ä½ç½®æˆ–ç«‹å³æ•°ï¼Œä½†<code>dest</code>å¿…é¡»æ˜¯å¯„å­˜å™¨ã€‚ç»“æœåŒæ ·è¢«æˆªæ–­åˆ°ç›®æ ‡æ“ä½œæ•°çš„å¤§å°ã€‚</p>
<h3 id="mul---æ— ç¬¦å·æ•´æ•°ä¹˜æ³•">mul - æ— ç¬¦å·æ•´æ•°ä¹˜æ³•
</h3><h4 id="mulçš„åŠŸèƒ½">mulçš„åŠŸèƒ½
</h4><p>â€‹	<code>MUL</code>æ˜¯ä¸€ä¸ªå•æ“ä½œæ•°æŒ‡ä»¤ï¼Œå®ƒéšå¼åœ°ä½¿ç”¨ALï¼ˆ8ä½ï¼‰ã€AXï¼ˆ16ä½ï¼‰ã€EAXï¼ˆ32ä½ï¼‰æˆ–RAXï¼ˆ64ä½ï¼‰ä½œä¸ºå…¶ä¸­ä¸€ä¸ªä¹˜æ•°ï¼Œå…·ä½“å–å†³äºæ“ä½œæ•°çš„å¤§å°å’Œå¤„ç†å™¨æ¨¡å¼ã€‚</p>
<p>â€‹	å¯¹äºå­—èŠ‚ä¹˜æ³•ï¼ˆ8ä½ï¼‰ï¼Œç»“æœè¢«å­˜å‚¨åœ¨AXå¯„å­˜å™¨ä¸­ï¼›å¯¹äºå­—ä¹˜æ³•ï¼ˆ16ä½ï¼‰ï¼Œç»“æœè¢«å­˜å‚¨åœ¨DX:AXå¯„å­˜å™¨å¯¹ä¸­ï¼›å¯¹äºåŒå­—ä¹˜æ³•ï¼ˆ32ä½ï¼‰ï¼Œç»“æœè¢«å­˜å‚¨åœ¨EDX:EAXå¯„å­˜å™¨å¯¹ä¸­ï¼›å¯¹äºå››å­—ä¹˜æ³•ï¼ˆ64ä½ï¼‰ï¼Œç»“æœè¢«å­˜å‚¨åœ¨RDX:RAXå¯„å­˜å™¨å¯¹ä¸­ã€‚</p>
<h4 id="mulçš„ç¤ºä¾‹">mulçš„ç¤ºä¾‹
</h4><pre tabindex="0"><code class="language-assembly" data-lang="assembly">; 8 
mov al, 0x05       ; AL = 5
mov bl, 0x03       ; BL = 3
mul bl             ; AX := AL * BL
; AL = 5 * 3 = 15 (0x0F), AH = 0

; 16
mov ax, 0x0123     ; AX = 291
mov bx, 0x0004     ; BX = 4
mul bx             ; DX:AX := AX * BX
; AX = 291 * 4 = 1164 (0x048C), DX = 0

; 32
mov eax, 0x12345678 ; EAX = 305419896
mov ebx, 0x00000002 ; EBX = 2
mul ebx             ; EDX:EAX := EAX * EBX
; EAX = 305419896 * 2 = 610839792 (0x2468ACF0), EDX = 0
</code></pre><h3 id="scanfä¸printfå‡½æ•°">scanfä¸printfå‡½æ•°
</h3><p>â€‹	scanfä¼šä½¿ç”¨å¤šä¸ªå¯„å­˜å™¨ï¼š<code>rcx</code>ï¼Œ<code>rdx</code>ï¼Œ<code>r8</code>ç­‰ç­‰ï¼Œå‡å­˜å‚¨è¾“å…¥é¡¹çš„åœ°å€ï¼Œå…¶ä¸­<code>rcx</code>ä¸ºæ ¼å¼åŒ–å­—ç¬¦ä¸²çš„åœ°å€ã€‚
â€‹	printfä½¿ç”¨çš„å¯„å­˜å™¨ä¸scanfç±»ä¼¼ã€‚</p>
<h2 id="é€†å‘åˆ†æç¨‹åº1">é€†å‘åˆ†æç¨‹åº1
</h2><p>â€‹	ä½¿ç”¨IDAæ‰“å¼€reverse_basic.exeï¼Œåæ±‡ç¼–ç»“æœå¦‚ä¸‹ï¼š</p>
<pre tabindex="0"><code class="language-assembly" data-lang="assembly">; int __fastcall main(int argc, const char **argv, const char **envp)
main proc near

var_18= dword ptr -18h
var_14= dword ptr -14h
var_10= qword ptr -10h
arg_0= qword ptr  8
arg_8= qword ptr  10h
arg_10= qword ptr  18h

; __unwind { // __GSHandlerCheck
mov     [rsp+arg_0], rbx
mov     [rsp+arg_8], rbp
mov     [rsp+arg_10], rsi
push    rdi
sub     rsp, 30h
mov     rax, cs:__security_cookie
xor     rax, rsp
mov     [rsp+38h+var_10], rax
lea     r8, [rsp+38h+var_18]
lea     rdx, [rsp+38h+var_14]
lea     rcx, aDD        ; &#34;%d %d&#34;
call    sub_140001080
mov     ecx, [rsp+38h+var_18]
mov     eax, 38E38E39h
add     ecx, [rsp+38h+var_14]
imul    r8d, ecx, 7
lea     rcx, Format     ; &#34;%d\n&#34;
lea     ebx, ds:0[r8*8]
lea     edi, [rbx+rbx*8]
mul     edi
mov     esi, edx
mov     edx, r8d
shr     esi, 1
mov     ebp, esi
shr     ebp, 3
call    sub_140001020
mov     edx, ebx
lea     rcx, Format     ; &#34;%d\n&#34;
call    sub_140001020
mov     edx, edi
lea     rcx, Format     ; &#34;%d\n&#34;
call    sub_140001020
mov     edx, esi
lea     rcx, aU         ; &#34;%u\n&#34;
call    sub_140001020
mov     edx, ebp
lea     rcx, aU         ; &#34;%u\n&#34;
call    sub_140001020
mov     eax, 24924925h
lea     rcx, aU         ; &#34;%u\n&#34;
mul     ebp
sub     ebp, edx
shr     ebp, 1
add     edx, ebp
shr     edx, 2
call    sub_140001020
xor     eax, eax
mov     rcx, [rsp+38h+var_10]
xor     rcx, rsp        ; StackCookie
call    __security_check_cookie
mov     rbx, [rsp+38h+arg_0]
mov     rbp, [rsp+38h+arg_8]
mov     rsi, [rsp+38h+arg_10]
add     rsp, 30h
pop     rdi
retn
; } // starts at 1400010E0
main endp
</code></pre><p>â€‹	å¯ä»¥å‘ç°è¯¥ç¨‹åºçš„ç»“æ„å¤§è‡´æ˜¯ï¼Œè¿›è¡Œä¸€äº›è¿ç®—ä¹‹åï¼Œé›†ä¸­æ‰“å°è¿ç®—ç»“æœã€‚å…¶ä¸­<code>sub_140001020</code>å³ä¸ºprinfå‡½æ•°ï¼Œ<code>sub_140001080</code>ä¸ºscanfå‡½æ•°ã€‚</p>
<pre tabindex="0"><code class="language-ssembly" data-lang="ssembly">lea     r8, [rsp+38h+var_18]
lea     rdx, [rsp+38h+var_14]
lea     rcx, aDD        ; &#34;%d %d&#34;
call    sub_140001080
</code></pre><p>â€‹	å› æ­¤æ­¤ç¨‹åºä¼šè¯»å–ä¸¤ä¸ªå››å­—èŠ‚æ•°æ®å†™å…¥<code>var_14</code>å’Œ<code>var_18</code>ã€‚</p>
<pre tabindex="0"><code class="language-assembly" data-lang="assembly">mov     ecx, [rsp+38h+var_18]
mov     eax, 38E38E39h
add     ecx, [rsp+38h+var_14]
imul    r8d, ecx, 7
</code></pre><p>â€‹	åˆ†ææ¥ä¸‹æ¥çš„æŒ‡ä»¤ï¼Œç¨‹åºå°†è¯»å–çš„ä¸¤ä¸ªæ•°ç›¸åŠ ä¹‹åä¹˜ä»¥7ï¼Œå°†ç»“æœå­˜åˆ°r8dä¸­ã€‚</p>
<pre tabindex="0"><code class="language-assembly" data-lang="assembly">lea     rcx, Format     ; &#34;%d\n&#34;
lea     ebx, ds:0[r8*8]
lea     edi, [rbx+rbx*8]
mul     edi
mov     esi, edx
mov     edx, r8d
shr     esi, 1
mov     ebp, esi
shr     ebp, 3
call    sub_140001020
</code></pre><p>â€‹	<code>lea     ebx, ds:0[r8*8]</code>é€šè¿‡åœ°å€è®¡ç®—çš„æ–¹å¼è®¡ç®—äº†<code>r8 * 8</code>çš„å€¼å­˜å…¥<code>ebx</code>ä¸­ï¼Œç„¶åç±»ä¼¼åœ°è®¡ç®—<code>rbx * 9</code>å­˜å…¥<code>edi</code>ä¸­ã€‚</p>
<p>â€‹	ç„¶åç»è¿‡å…¶ä»–æ— å…³è¿ç®—åï¼Œè°ƒç”¨<code>printf</code>å°†<code>r8d</code>(ä¹˜ä»¥7çš„ç»“æœ)æ‰“å°å‡ºæ¥ï¼ˆå…ˆå°†r8dèµ‹ç»™edxï¼‰ã€‚</p>
<pre tabindex="0"><code class="language-assembly" data-lang="assembly">mov     edx, ebx
lea     rcx, Format     ; &#34;%d\n&#34;
call    sub_140001020
mov     edx, edi
lea     rcx, Format     ; &#34;%d\n&#34;
call    sub_140001020
</code></pre><p>â€‹	è¿™ä¸€æ®µæ‰“å°å‡º<code>ebx</code>å’Œ<code>edi</code>ã€‚</p>
<pre tabindex="0"><code class="language-assembly" data-lang="assembly">mov     edx, esi
lea     rcx, aU         ; &#34;%u\n&#34;
call    sub_140001020
mov     edx, ebp
lea     rcx, aU         ; &#34;%u\n&#34;
call    sub_140001020
</code></pre><p>â€‹	æ ¹æ®è¿™ä¸¤ä¸ªæ‰“å°å¯ä»¥çŸ¥é“ï¼Œåœ¨ä¸Šé¢çš„è¿ç®—ä¸­ï¼Œ<code>esi</code>å’Œ<code>ebp</code>è¢«å­˜å…¥äº†è¿ç®—ç»“æœï¼Œè®©æˆ‘ä»¬å†æ¬¡åˆ†æä¸Šé¢è¢«æˆ‘ä»¬å¿½è§†çš„éƒ¨åˆ†æŒ‡ä»¤ï¼š</p>
<pre tabindex="0"><code class="language-assembly" data-lang="assembly">mov     eax, 38E38E39h
...
lea     rcx, Format     ; &#34;%d\n&#34;
lea     ebx, ds:0[r8*8]
lea     edi, [rbx+rbx*8]
mul     edi
mov     esi, edx
mov     edx, r8d
shr     esi, 1
mov     ebp, esi
shr     ebp, 3
call    sub_140001020
</code></pre><p>â€‹	<code>mul edi</code>çš„ä½œç”¨ï¼šä¼šè®¡ç®—<code>edi * eax</code>ï¼Œå°†ç»“æœå­˜å…¥<code>edx: eax</code>ä¸­ï¼Œeaxè¢«èµ‹å€¼ä¸º<code>38E38E39h</code>ï¼Œæ˜¯ç¼–è¯‘å™¨å°†é™¤ä»¥9è¿ç®—è¿›è¡Œä¼˜åŒ–ä½¿ç”¨çš„é­”æ•°ã€‚å› æ­¤<code>esi</code>ä¸º<code>edi / 9</code>ã€‚ç„¶åå°†<code>esi</code>å­˜å…¥<code>ebp</code>åå³ç§»3ä½ã€‚</p>
<pre tabindex="0"><code class="language-assembly" data-lang="assembly">mov     eax, 24924925h
lea     rcx, aU         ; &#34;%u\n&#34;
mul     ebp
sub     ebp, edx
shr     ebp, 1
add     edx, ebp
shr     edx, 2
call    sub_140001020
</code></pre><p>â€‹	<code>24924925h</code>æ˜¯é™¤ä»¥7çš„é­”æ•°ï¼Œå› æ­¤è¿™é‡Œè®¡ç®—<code>ebp</code>é™¤ä»¥7åæ‰“å°å‡ºæ¥ã€‚</p>
<p>ç»¼ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥å¤åŸè¿™ä¸ªå¯æ‰§è¡Œæ–‡ä»¶çš„åŸcæ–‡ä»¶ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nf">scanf</span><span class="p">(</span><span class="s">&#34;%d %d&#34;</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">c</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">n1</span> <span class="o">=</span> <span class="n">c</span> <span class="o">*</span> <span class="mi">7</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">n2</span> <span class="o">=</span> <span class="n">n1</span> <span class="o">*</span> <span class="mi">8</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">n3</span> <span class="o">=</span> <span class="n">n2</span> <span class="o">*</span> <span class="mi">9</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">n4</span> <span class="o">=</span> <span class="n">n3</span> <span class="o">/</span> <span class="mi">9</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">n5</span> <span class="o">=</span> <span class="n">n4</span> <span class="o">/</span> <span class="mi">8</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">n6</span> <span class="o">=</span> <span class="n">n5</span> <span class="o">/</span> <span class="mi">7</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;%d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">n1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;%d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">n2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;%d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">n3</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;%u</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">n4</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;%u</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">n5</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;%u</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">n6</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h2 id="é€†å‘åˆ†æç¨‹åº2">é€†å‘åˆ†æç¨‹åº2
</h2><pre tabindex="0"><code class="language-assembly" data-lang="assembly">; int __fastcall main(int argc, const char **argv, const char **envp)
main proc near

var_18= dword ptr -18h
var_14= dword ptr -14h
var_10= qword ptr -10h
arg_0= qword ptr  8

; __unwind { // __GSHandlerCheck
mov     [rsp+arg_0], rbx
push    rdi
sub     rsp, 30h
mov     rax, cs:__security_cookie
xor     rax, rsp
mov     [rsp+38h+var_10], rax
lea     r8, [rsp+38h+var_14]
lea     rdx, [rsp+38h+var_18]
lea     rcx, aDD        ; &#34;%d %d&#34;
call    sub_140001080
mov     eax, [rsp+38h+var_14]
lea     rcx, Format     ; &#34;%d\n&#34;
mov     edi, [rsp+38h+var_18]
lea     ebx, [rdi+rax]
imul    edi, eax
lea     edx, [rdi+rbx]
call    sub_140001020
mov     eax, 66666667h
imul    [rsp+38h+var_18]
sar     edx, 1
mov     ecx, edx
shr     ecx, 1Fh
add     edx, ecx
lea     rcx, Format     ; &#34;%d\n&#34;
call    sub_140001020
mov     r8d, [rsp+38h+var_14]
lea     rcx, Format     ; &#34;%d\n&#34;
lea     edx, [r8+r8*4]
call    sub_140001020
sub     ebx, [rsp+38h+var_18]
lea     rcx, Format     ; &#34;%d\n&#34;
mov     edx, ebx
call    sub_140001020
mov     eax, edi
lea     rcx, Format     ; &#34;%d\n&#34;
cdq
idiv    [rsp+38h+var_14]
mov     edx, eax
call    sub_140001020
xor     eax, eax
mov     rcx, [rsp+38h+var_10]
xor     rcx, rsp        ; StackCookie
call    __security_check_cookie
mov     rbx, [rsp+38h+arg_0]
add     rsp, 30h
pop     rdi
retn
; } // starts at 1400010E0
main endp
</code></pre><pre tabindex="0"><code class="language-assembly" data-lang="assembly">lea     r8, [rsp+38h+var_14]
lea     rdx, [rsp+38h+var_18]
lea     rcx, aDD        ; &#34;%d %d&#34;
call    sub_140001080
</code></pre><p>â€‹	å®¹æ˜“çŸ¥é“ï¼Œè¿™é‡Œä½¿ç”¨scanfå‡½æ•°è¯»å…¥ä¸¤ä¸ªæ•°æ®å­˜å…¥<code>var_18</code>ï¼Œ <code>var_14</code>ä¸­ã€‚</p>
<pre tabindex="0"><code class="language-assembly" data-lang="assembly">mov     eax, [rsp+38h+var_14]
lea     rcx, Format     ; &#34;%d\n&#34;
mov     edi, [rsp+38h+var_18]
lea     ebx, [rdi+rax]
imul    edi, eax
lea     edx, [rdi+rbx]
call    sub_140001020
</code></pre><p>â€‹	è¿™æ®µé¦–å…ˆå°†<code>var_14</code>å’Œ<code>var_18</code>åˆ†åˆ«å­˜å…¥<code>eax</code>å’Œ<code>edi</code>ä¸­ã€‚è®¡ç®—<code>ebx = rdi + rax</code>ï¼Œè®¡ç®—<code>edi = edi * eax</code>ï¼Œ è®¡ç®—<code>edx = rdi + rbx</code>ã€‚å³ä¸ºè®¡ç®—<code>edx = var_14 + var_18 + var_14 * var_18</code>ç„¶åæ‰“å°å‡ºæ¥ã€‚</p>
<pre tabindex="0"><code class="language-assembly" data-lang="assembly">mov     eax, 66666667h
imul    [rsp+38h+var_18]
sar     edx, 1
mov     ecx, edx
shr     ecx, 1Fh
add     edx, ecx
lea     rcx, Format     ; &#34;%d\n&#34;
call    sub_140001020
</code></pre><p>â€‹	è¿™é‡Œæ˜¯ä½¿ç”¨é­”æ•°<code>66666667h</code>ä¼˜åŒ–é™¤æ³•è¿ç®—ã€‚å®é™…ä¸Šè®¡ç®—çš„æ˜¯<code>var_18 / 5</code>ã€‚</p>
<pre tabindex="0"><code class="language-assembly" data-lang="assembly">mov     r8d, [rsp+38h+var_14]
lea     rcx, Format     ; &#34;%d\n&#34;
lea     edx, [r8+r8*4]
call    sub_140001020
</code></pre><p>â€‹	å®¹æ˜“çŸ¥é“è¿™é‡Œè®¡ç®—çš„æ˜¯<code>var_14 * 5</code>ï¼Œä½¿ç”¨<code>var_14 * 4 + var_14</code>ä¼˜åŒ–ã€‚</p>
<pre tabindex="0"><code class="language-assembly" data-lang="assembly">sub     ebx, [rsp+38h+var_18]
lea     rcx, Format     ; &#34;%d\n&#34;
mov     edx, ebx
call    sub_140001020
mov     eax, edi
lea     rcx, Format     ; &#34;%d\n&#34;
cdq
idiv    [rsp+38h+var_14]
mov     edx, eax
call    sub_140001020
</code></pre><p>â€‹	ebxåœ¨ä¹‹å‰å­˜å‚¨ç€<code>var_18 + var_14</code>çš„ç»“æœï¼Œå› æ­¤è¿™é‡Œè®¡ç®—<code>ebx - var_18</code>åæ‰“å°ã€‚</p>
<p>â€‹	ediå­˜å‚¨ç€<code>var_18 * var_14</code>çš„ç»“æœï¼Œè¿™é‡Œè®¡ç®—<code>var_18 * var14 / var_14</code>åæ‰“å°ã€‚</p>
<p>æºç ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">var_18</span><span class="p">,</span> <span class="n">var_14</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nf">scanf</span><span class="p">(</span><span class="s">&#34;%d %d&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">var_18</span><span class="p">,</span> <span class="n">var_14</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">a</span> <span class="o">=</span> <span class="n">var_18</span> <span class="o">+</span> <span class="n">var_14</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">b</span> <span class="o">=</span> <span class="n">var_18</span> <span class="o">*</span> <span class="n">var_14</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;%d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;%d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">var_18</span> <span class="o">/</span> <span class="mi">5</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;%d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">var_14</span> <span class="o">*</span> <span class="mi">5</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;%d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">a</span> <span class="o">-</span> <span class="n">var_18</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;%d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">b</span> <span class="o">/</span> <span class="n">var_14</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div>
</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/xingfen-star.github.io/tags/%E8%BD%AF%E4%BB%B6%E9%80%86%E5%90%91/">è½¯ä»¶é€†å‘</a>
        
    </section>


    <section class="article-lastmod">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



        <span>
            Last updated on Mar 17, 2025 05:30 UTC
        </span>
    </section></footer>


    
</article>

    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">Related content</h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="">
    <a href="/xingfen-star.github.io/post/reverse-program-course-week1/">

        

        <div class="article-details">
            <h2 class="article-title">ã€æ­¦å¤§è½¯ä»¶é€†å‘è¯¾ç¨‹/ç¬¬ä¸€å‘¨ã€‘æ‰«é›·é€†å‘åˆ†ææ‰¹é‡æ’æ——åŠæœºå™¨æŒ‡ä»¤è¡¨.exeæ–‡ä»¶å­—ä½“æ›´æ¢</h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>


    
        
    

    <footer class="site-footer">
    <section class="copyright">
        &copy;
        
            2025 -
        
        2025 è¿œæ¥’
    </section>

    <section class="powerby">
        
            æ˜Ÿè—ç‚¹é›ªï¼Œæœˆéšæ™¦æ˜ <br/>
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.29.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link
                rel="stylesheet"
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link
                rel="stylesheet"
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/xingfen-star.github.io/ts/main.1b68ca70253b523eabb06a943631ea672d424976a40c495cc6a889635f51d0f9.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>
<style>
    #TableOfContents > ul, ol {
        ul, ol {
            display: none;
        }
        .open {
            display: block;
        }
    }
</style>

<script>
    function initTocHide() {
        
        let toc = document.querySelector(".widget--toc");
        if (!toc) {
            return;
        }
        
        window.addEventListener('scroll', function() {
            
            let currentLi = document.querySelector(".active-class");
            if (!currentLi) {
                return
            }
            
            let elementsByClassName = document.querySelectorAll(".open");
            if (elementsByClassName.length > 0) {
                elementsByClassName.forEach((ul) => {
                    ul.classList.remove("open")
                })
            }
            
            if (currentLi.children.length > 1) {
                currentLi.children[1].classList.add("open")
            }
            
            let ul = currentLi.parentElement;
            do {
                ul.classList.add("open");
                ul = ul.parentElement.parentElement
            } while (ul !== undefined && (ul.localName === 'ul' || ul.localName === 'ol'))
        });
    }
    initTocHide()
</script>

    </body>
</html>

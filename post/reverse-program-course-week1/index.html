<!DOCTYPE html>
<html lang="zh" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content="作业目标 逆向分析扫雷程序winmine.exe，并编写程序对其进行批量插旗\n更换机器指令表.exe内的显示字体\n扫雷 定位绘制雷区的代码位置 使用Ollydbg打开winmin.exe。\n在当前模块中右键-&gt;查找-&gt;当前模块中的名称（标签），在弹出的窗口中寻找名称为Bitblt的函数。这里可以直接右键-&gt;在每个参考上设置断点，但是我的Ollydbg会报错。因此采用后续的方法。\n选中Bitblt项后，按回车键Enter，在弹出的窗口中再次按回车Enter。\n执行上述操作后弹出的窗口即为Bitblt的源码，在源码首行按F2或者右键设置断点。\n设置断点后按F9或功能按钮运行程序，程序会暂停在断点处。此时按Ctrl + F9或者功能按钮执行到返回，程序会运行到函数Bitblt调用处的下一行。\n观察上下文程序可以发现是类似于一个循环的结构，其中esi寄存器为循环变量。\n定位雷区数据地址 在这一节内需要观察不同操作下内存区域的变化。\n在Ollydbg中可以通过单击任意数据来刷新数据窗口中的内容。\n如果想要重新绘制扫雷窗口，需要最小化后恢复窗口。\n观察内存读取部分，代码中只有两句可能是对于数组的读取。分别为：\nmov al, byte ptr [ebx+esi] push dword ptr [eax*4+1005A20] 这里可以记录一下Bitblt调用处的地址1002706，然后取消所有断点重新运行程序，将游戏切换到高级模式，随机点击一个地块。这里为了便于定位雷区数据位置，我们多次开局点击地块，直到仅连锁翻开一个地块（这样对雷区数据的影响较小，数据特征更明显）。\n然后将在数据窗口中右键-&gt;转到-&gt;表达式或者按Ctrl + G，输入内存读取部分的常量地址1005A20跳转到该地址。观察数据窗口内该地址处的数据。\n">
<title>【武大软件逆向课程/第一周】扫雷逆向分析批量插旗及机器指令表.exe文件字体更换</title>

<link rel='canonical' href='https://xingfend.github.io/xingfen-star.github.io/post/reverse-program-course-week1/'>

<link rel="stylesheet" href="/xingfen-star.github.io/scss/style.min.c0fa910106829adb3edb67524eba5dffc21500fdd220ea53e6ba412a6f0ce2fe.css"><meta property='og:title' content="【武大软件逆向课程/第一周】扫雷逆向分析批量插旗及机器指令表.exe文件字体更换">
<meta property='og:description' content="作业目标 逆向分析扫雷程序winmine.exe，并编写程序对其进行批量插旗\n更换机器指令表.exe内的显示字体\n扫雷 定位绘制雷区的代码位置 使用Ollydbg打开winmin.exe。\n在当前模块中右键-&gt;查找-&gt;当前模块中的名称（标签），在弹出的窗口中寻找名称为Bitblt的函数。这里可以直接右键-&gt;在每个参考上设置断点，但是我的Ollydbg会报错。因此采用后续的方法。\n选中Bitblt项后，按回车键Enter，在弹出的窗口中再次按回车Enter。\n执行上述操作后弹出的窗口即为Bitblt的源码，在源码首行按F2或者右键设置断点。\n设置断点后按F9或功能按钮运行程序，程序会暂停在断点处。此时按Ctrl + F9或者功能按钮执行到返回，程序会运行到函数Bitblt调用处的下一行。\n观察上下文程序可以发现是类似于一个循环的结构，其中esi寄存器为循环变量。\n定位雷区数据地址 在这一节内需要观察不同操作下内存区域的变化。\n在Ollydbg中可以通过单击任意数据来刷新数据窗口中的内容。\n如果想要重新绘制扫雷窗口，需要最小化后恢复窗口。\n观察内存读取部分，代码中只有两句可能是对于数组的读取。分别为：\nmov al, byte ptr [ebx+esi] push dword ptr [eax*4+1005A20] 这里可以记录一下Bitblt调用处的地址1002706，然后取消所有断点重新运行程序，将游戏切换到高级模式，随机点击一个地块。这里为了便于定位雷区数据位置，我们多次开局点击地块，直到仅连锁翻开一个地块（这样对雷区数据的影响较小，数据特征更明显）。\n然后将在数据窗口中右键-&gt;转到-&gt;表达式或者按Ctrl + G，输入内存读取部分的常量地址1005A20跳转到该地址。观察数据窗口内该地址处的数据。\n">
<meta property='og:url' content='https://xingfend.github.io/xingfen-star.github.io/post/reverse-program-course-week1/'>
<meta property='og:site_name' content='远楒'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='软件逆向' /><meta property='article:tag' content='c语言' /><meta property='article:published_time' content='2025-02-19T17:43:52&#43;08:00'/><meta property='article:modified_time' content='2025-03-15T08:00:20&#43;00:00'/>
<meta name="twitter:title" content="【武大软件逆向课程/第一周】扫雷逆向分析批量插旗及机器指令表.exe文件字体更换">
<meta name="twitter:description" content="作业目标 逆向分析扫雷程序winmine.exe，并编写程序对其进行批量插旗\n更换机器指令表.exe内的显示字体\n扫雷 定位绘制雷区的代码位置 使用Ollydbg打开winmin.exe。\n在当前模块中右键-&gt;查找-&gt;当前模块中的名称（标签），在弹出的窗口中寻找名称为Bitblt的函数。这里可以直接右键-&gt;在每个参考上设置断点，但是我的Ollydbg会报错。因此采用后续的方法。\n选中Bitblt项后，按回车键Enter，在弹出的窗口中再次按回车Enter。\n执行上述操作后弹出的窗口即为Bitblt的源码，在源码首行按F2或者右键设置断点。\n设置断点后按F9或功能按钮运行程序，程序会暂停在断点处。此时按Ctrl + F9或者功能按钮执行到返回，程序会运行到函数Bitblt调用处的下一行。\n观察上下文程序可以发现是类似于一个循环的结构，其中esi寄存器为循环变量。\n定位雷区数据地址 在这一节内需要观察不同操作下内存区域的变化。\n在Ollydbg中可以通过单击任意数据来刷新数据窗口中的内容。\n如果想要重新绘制扫雷窗口，需要最小化后恢复窗口。\n观察内存读取部分，代码中只有两句可能是对于数组的读取。分别为：\nmov al, byte ptr [ebx+esi] push dword ptr [eax*4+1005A20] 这里可以记录一下Bitblt调用处的地址1002706，然后取消所有断点重新运行程序，将游戏切换到高级模式，随机点击一个地块。这里为了便于定位雷区数据位置，我们多次开局点击地块，直到仅连锁翻开一个地块（这样对雷区数据的影响较小，数据特征更明显）。\n然后将在数据窗口中右键-&gt;转到-&gt;表达式或者按Ctrl + G，输入内存读取部分的常量地址1005A20跳转到该地址。观察数据窗口内该地址处的数据。\n">
    <link rel="shortcut icon" href="/xingfen-star.github.io/favicon.ico" />

    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="Toggle Menu">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/xingfen-star.github.io/">
                
                    

                    
                        
                        <img src="/xingfen-star.github.io/img/avatar_hu_e75ba5eda9add5a4.png" width="300"
                            height="279" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
                    <span class="emoji">😉</span>
                
            </figure>
            
        

        <div class="site-meta">
            <h1 class="site-name"><a href="/xingfen-star.github.io">远楒</a></h1>
            <h2 class="site-description">星分.</h2>
        </div>
    </header><ol class="menu-social">
            
                <li>
                    <a
                        href='https://space.bilibili.com/473214036'
                        target="_blank"
                        title="Bilibili"
                        rel="me"
                    >
                        
                        
                            <svg class="icon" style="width: 24;height: 24;vertical-align: middle;fill: currentColor;overflow: hidden;" viewBox="0 0 2299 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1461"><path d="M1775.840814 322.588002c6.0164 1.002733 53.144869-9.525967 55.150336-6.016401 3.0082 4.5123 24.065601 155.92504 18.550567 156.927774s-44.621635 10.027334-44.621635 10.027334c-3.0082-20.556034-28.577901-147.903173-29.079268-160.938707m75.205003-14.539634l20.556034 162.944174c10.5287-0.501367 53.144869-3.509567 57.155803-4.010934-6.0164-61.668103-16.545101-158.933241-16.545101-158.93324-20.054668-4.010934-41.112069-4.010934-61.166736 0m-40.610702 226.116376s92.752838-23.564234 126.344406-12.0328c17.046467 61.668103 48.131202 407.611118 51.139402 421.649386-21.057401 2.506833-90.246004 8.523234-95.761037 10.027333-4.5123-26.071068-81.72277-403.098818-81.722771-419.643919m343.436183-207.565809c5.515034 1.5041 54.648969-5.013667 55.150335-1.5041 1.002733 12.032801 6.0164 157.42914 0.501367 157.930507s-44.621635 4.010934-44.621635 4.010934c-1.002733-20.054668-12.032801-146.90044-11.030067-160.437341m75.70637-4.010933l4.010933 160.938707c10.5287 0 52.643502 2.506833 57.155803 2.005467-1.002733-61.668103 0-158.933241 0-158.933241-20.054668-3.509567-40.610702-5.013667-61.166736-4.010933m-64.676303 216.089043s94.758304-12.534167 126.845772 2.506833c7.019134 72.196803 6.0164 408.613852 7.019134 422.652119-21.558768 0-90.246004 1.002733-95.761038 2.005467-1.002733-26.071068-39.607968-410.619319-38.103868-427.164419m-220.099977-413.627519c54.648969 278.759879 96.262404 755.058234 97.766504 785.641602 0 0 43.117535 1.002733 91.750105 4.010934C2105.740095 614.383415 2070.644427 134.575493 2071.145794 119.033126c-12.032801-13.536901-126.344406 6.0164-126.344406 6.0164m-120.328005 659.297196c-10.5287-78.213204-290.291313-166.955108-447.720454-138.377206 0 0-19.553301-172.470141-27.073801-339.425248-6.517767-143.390873-1.002733-282.770813 0.501366-305.833681-10.5287-7.5205-123.837572 46.627102-185.004308 69.188603 0 0 73.199537 309.844614 126.344406 952.59671 0 0 84.730971 9.0246 230.12731-19.051934s317.365114-115.815705 302.825481-219.097244m-341.932083 140.88404l-24.566967-176.982441c6.0164-3.0082 156.927774 53.144869 172.971507 63.172203-2.506833 11.030067-148.40454 113.810238-148.40454 113.810238M610.664628 322.588002c6.0164 1.002733 53.144869-9.525967 55.150335-6.016401 3.0082 4.5123 24.065601 155.92504 18.550568 156.927774s-44.621635 10.027334-44.621635 10.027334c-3.0082-20.556034-28.577901-147.903173-29.079268-160.938707m75.205003-14.539634l20.556034 162.944174c10.5287-0.501367 53.144869-3.509567 57.155803-4.010934-6.517767-61.668103-16.545101-158.933241-16.545101-158.93324-20.054668-4.010934-41.112069-4.010934-61.166736 0m-40.610702 226.116376s92.752838-23.564234 126.344406-12.0328c17.046467 61.668103 48.131202 407.611118 51.139402 421.649386-21.057401 2.506833-90.246004 8.523234-95.761037 10.027333-4.5123-26.071068-81.72277-403.098818-81.722771-419.643919m343.436182-207.565809c5.515034 1.5041 54.648969-5.013667 55.150336-1.5041 1.002733 12.032801 6.0164 157.42914 0.501367 157.930507s-44.621635 4.010934-44.621635 4.010934c-1.002733-20.054668-11.531434-146.90044-11.030068-160.437341m75.706371-4.010933l4.010933 160.938707c10.5287 0 52.643502 2.506833 57.155803 2.005467-1.002733-61.668103 0-158.933241 0-158.933241-20.054668-3.509567-40.610702-4.5123-61.166736-4.010933m-64.676303 216.089043s94.758304-12.534167 126.845772 2.506833c7.019134 72.196803 6.0164 408.613852 7.019134 422.652119-21.558768 0-90.246004 1.002733-95.761038 2.005467-0.501367-26.071068-39.607968-410.619319-38.103868-427.164419m-220.099977-413.627519c54.648969 278.759879 96.262404 755.058234 97.766504 785.641602 0 0 43.117535 1.002733 91.750105 4.010934-28.577901-300.318647-63.67357-780.126569-63.172203-796.170303-12.032801-13.035534-126.344406 6.517767-126.344406 6.517767m-120.328005 659.297196c-10.5287-78.213204-290.291313-166.955108-447.720454-138.377206 0 0-19.553301-172.470141-27.073801-339.425248-6.517767-143.390873-1.002733-282.770813 0.501366-305.833681C174.475608-6.308547 61.166736 47.337689 0 69.89919c0 0 73.199537 309.844614 126.344406 952.59671 0 0 84.730971 9.0246 230.12731-19.051934s317.365114-115.815705 302.825481-219.097244m-341.932083 140.88404l-24.566967-176.982441c6.0164-3.0082 156.927774 53.144869 172.971507 63.172203-2.506833 11.030067-148.40454 113.810238-148.40454 113.810238" p-id="1462"></path></svg>
                        
                    </a>
                </li>
            
                <li>
                    <a
                        href='https://github.com/xingfend'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <?xml version="1.0" encoding="UTF-8"?><svg width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M29.3444 30.4765C31.7481 29.977 33.9292 29.1108 35.6247 27.8391C38.5202 25.6676 40 22.3136 40 18.9999C40 16.6752 39.1187 14.505 37.5929 12.6668C36.7427 11.6425 39.2295 3.99989 37.02 5.02919C34.8105 6.05848 31.5708 8.33679 29.8726 7.83398C28.0545 7.29565 26.0733 6.99989 24 6.99989C22.1992 6.99989 20.4679 7.22301 18.8526 7.6344C16.5046 8.23237 14.2591 5.99989 12 5.02919C9.74086 4.05848 10.9736 11.9632 10.3026 12.7944C8.84119 14.6051 8 16.7288 8 18.9999C8 22.3136 9.79086 25.6676 12.6863 27.8391C14.6151 29.2857 17.034 30.2076 19.7401 30.6619" stroke="#707070" stroke-width="4" stroke-linecap="round"/><path d="M19.7397 30.6619C18.5812 31.937 18.002 33.1478 18.002 34.2944C18.002 35.441 18.002 38.3464 18.002 43.0106" stroke="#707070" stroke-width="4" stroke-linecap="round"/><path d="M29.3446 30.4766C30.4423 31.9174 30.9912 33.211 30.9912 34.3576C30.9912 35.5042 30.9912 38.3885 30.9912 43.0107" stroke="#707070" stroke-width="4" stroke-linecap="round"/><path d="M6 31.2155C6.89887 31.3254 7.56554 31.7387 8 32.4554C8.65169 33.5303 11.0742 37.518 13.8251 37.518C15.6591 37.518 17.0515 37.518 18.0024 37.518" stroke="#707070" stroke-width="4" stroke-linecap="round"/></svg>
                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/xingfen-star.github.io/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>主页</span>
            </a>
        </li>
        
        
        <li >
            <a href='/xingfen-star.github.io/page/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>归档</span>
            </a>
        </li>
        
        
        <li >
            <a href='/xingfen-star.github.io/page/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>搜索</span>
            </a>
        </li>
        
        
        <li >
            <a href='/xingfen-star.github.io/page/about/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>关于</span>
            </a>
        </li>
        
        
        <li >
            <a href='/xingfen-star.github.io/page/links/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5" />
  <path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5" />
</svg>



                
                <span>链接</span>
            </a>
        </li>
        
        <li class="menu-bottom-section">
            <ol class="menu">

                
                    <li id="dark-mode-toggle">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <span>Dark Mode</span>
                    </li>
                
                
            </ol>
        </li>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">Table of contents</h2>

        <div class="widget--toc">
            <nav id="TableOfContents">
  <ul>
    <li><a href="#作业目标">作业目标</a></li>
    <li><a href="#扫雷">扫雷</a>
      <ul>
        <li><a href="#定位绘制雷区的代码位置">定位绘制雷区的代码位置</a></li>
        <li><a href="#定位雷区数据地址">定位雷区数据地址</a></li>
        <li><a href="#分析地块状态对应的内存值">分析地块状态对应的内存值</a></li>
        <li><a href="#编写程序以批量插旗地雷">编写程序以批量插旗地雷</a></li>
        <li><a href="#实验结果">实验结果</a></li>
      </ul>
    </li>
    <li><a href="#更换机器指令表exe显示字体">更换机器指令表.exe显示字体</a>
      <ul>
        <li><a href="#定位控制字体显示的winapi">定位控制字体显示的WinAPI</a></li>
        <li><a href="#将修改保存到文件">将修改保存到文件</a></li>
      </ul>
    </li>
  </ul>
</nav>
        </div>
    </section>

            
        
            
                
<section class="widget curTags">
    <div class="widget-icon">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-tag" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11 3L20 12a1.5 1.5 0 0 1 0 2L14 20a1.5 1.5 0 0 1 -2 0L3 11v-4a4 4 0 0 1 4 -4h4" />
  <circle cx="9" cy="9" r="2" />
</svg>



    </div>
    <h2 class="widget-title section-title">Tags of current blog</h2>
    <div class="curTags-tags">
        
            <a href="/xingfen-star.github.io/tags/%E8%BD%AF%E4%BB%B6%E9%80%86%E5%90%91/">
                软件逆向
            </a>
        
            <a href="/xingfen-star.github.io/tags/c%E8%AF%AD%E8%A8%80/">
                C语言
            </a>
        
    </div>
</section>

            
        
    </aside>


            <main class="main full-width">
    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/xingfen-star.github.io/categories/course/" style="background-color: #2a9d8f; color: #fff;">
                课程作业
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/xingfen-star.github.io/post/reverse-program-course-week1/">【武大软件逆向课程/第一周】扫雷逆向分析批量插旗及机器指令表.exe文件字体更换</a>
        </h2>

        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Feb 19, 2025</time>
            </div>
        

        
        <div class="article-lastmod">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time>
                    Mar 15, 2025 08:00 UTC
                </time>
            </div>
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    3 minute read
                </time>
            </div>
        

    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <h2 id="作业目标">作业目标
</h2><ul>
<li>
<p>逆向分析扫雷程序winmine.exe，并编写程序对其进行批量插旗</p>
</li>
<li>
<p>更换机器指令表.exe内的显示字体</p>
</li>
</ul>
<h2 id="扫雷">扫雷
</h2><h3 id="定位绘制雷区的代码位置">定位绘制雷区的代码位置
</h3><p>    使用Ollydbg打开winmin.exe。</p>
<p><img src="/xingfen-star.github.io/post/reverse-program-course-week1/img/2025-02-19-17-54-55-image.png"
	width="2888"
	height="1532"
	srcset="/xingfen-star.github.io/post/reverse-program-course-week1/img/2025-02-19-17-54-55-image_hu_270f472e42454755.png 480w, /xingfen-star.github.io/post/reverse-program-course-week1/img/2025-02-19-17-54-55-image_hu_41fc272102c93729.png 1024w"
	loading="lazy"
	
		alt="使用Ollydbg打开winmin.exe"
	
	
		class="gallery-image" 
		data-flex-grow="188"
		data-flex-basis="452px"
	
></p>
<p>    在当前模块中右键-&gt;查找-&gt;当前模块中的名称（标签），在弹出的窗口中寻找名称为Bitblt的函数。这里可以直接右键-&gt;在每个参考上设置断点，但是我的Ollydbg会报错。因此采用后续的方法。</p>
<p><img src="/xingfen-star.github.io/post/reverse-program-course-week1/img/2025-02-19-17-57-45-image.png"
	width="1892"
	height="1264"
	srcset="/xingfen-star.github.io/post/reverse-program-course-week1/img/2025-02-19-17-57-45-image_hu_1f82fe34cc9e7583.png 480w, /xingfen-star.github.io/post/reverse-program-course-week1/img/2025-02-19-17-57-45-image_hu_fd10ea226f71803a.png 1024w"
	loading="lazy"
	
		alt="寻找Bitblt函数"
	
	
		class="gallery-image" 
		data-flex-grow="149"
		data-flex-basis="359px"
	
></p>
<p>    选中<code>Bitblt</code>项后，按回车键<kbd>Enter</kbd>，在弹出的窗口中再次按回车<kbd>Enter</kbd>。</p>
<p><img src="/xingfen-star.github.io/post/reverse-program-course-week1/img/2025-02-19-18-01-50-image.png"
	width="2376"
	height="585"
	srcset="/xingfen-star.github.io/post/reverse-program-course-week1/img/2025-02-19-18-01-50-image_hu_7a211291ae279414.png 480w, /xingfen-star.github.io/post/reverse-program-course-week1/img/2025-02-19-18-01-50-image_hu_ff531f66f8d25d74.png 1024w"
	loading="lazy"
	
		alt="定位Bitblt源码"
	
	
		class="gallery-image" 
		data-flex-grow="406"
		data-flex-basis="974px"
	
></p>
<p>    执行上述操作后弹出的窗口即为<code>Bitblt</code>的源码，在源码首行按<kbd>F2</kbd>或者右键设置断点。</p>
<p><img src="/xingfen-star.github.io/post/reverse-program-course-week1/img/2025-02-19-18-07-04-image.png"
	width="1364"
	height="750"
	srcset="/xingfen-star.github.io/post/reverse-program-course-week1/img/2025-02-19-18-07-04-image_hu_e5ac1af64f1422b3.png 480w, /xingfen-star.github.io/post/reverse-program-course-week1/img/2025-02-19-18-07-04-image_hu_a308485288e8563.png 1024w"
	loading="lazy"
	
		alt="在Bitblt函数源码首行打断点"
	
	
		class="gallery-image" 
		data-flex-grow="181"
		data-flex-basis="436px"
	
></p>
<p>    设置断点后按<kbd>F9</kbd>或功能按钮运行程序，程序会暂停在断点处。此时按<kbd>Ctrl</kbd> + <kbd>F9</kbd>或者功能按钮<code>执行到返回</code>，程序会运行到函数<code>Bitblt</code>调用处的下一行。</p>
<p><img src="/xingfen-star.github.io/post/reverse-program-course-week1/img/2025-02-19-18-13-07-image.png"
	width="1560"
	height="836"
	srcset="/xingfen-star.github.io/post/reverse-program-course-week1/img/2025-02-19-18-13-07-image_hu_82022b90e7fc9233.png 480w, /xingfen-star.github.io/post/reverse-program-course-week1/img/2025-02-19-18-13-07-image_hu_8c10c129043f8ac6.png 1024w"
	loading="lazy"
	
		alt="Bitblt调用处上下文"
	
	
		class="gallery-image" 
		data-flex-grow="186"
		data-flex-basis="447px"
	
></p>
<p>    观察上下文程序可以发现是类似于一个循环的结构，其中esi寄存器为循环变量。</p>
<h3 id="定位雷区数据地址">定位雷区数据地址
</h3><blockquote>
<p>在这一节内需要观察不同操作下内存区域的变化。</p>
<p>在Ollydbg中可以通过单击任意数据来刷新数据窗口中的内容。</p>
<p>如果想要重新绘制扫雷窗口，需要最小化后恢复窗口。</p></blockquote>
<p>    观察内存读取部分，代码中只有两句可能是对于数组的读取。分别为：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nasm" data-lang="nasm"><span class="line"><span class="cl"><span class="nf">mov</span>    <span class="nb">al</span><span class="p">,</span> <span class="kt">byte</span> <span class="nv">ptr</span> <span class="p">[</span><span class="nb">ebx</span><span class="o">+</span><span class="nb">esi</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nf">push</span>   <span class="kt">dword</span> <span class="nv">ptr</span> <span class="p">[</span><span class="nb">eax</span><span class="o">*</span><span class="mi">4</span><span class="o">+</span><span class="mi">1005</span><span class="nv">A20</span><span class="p">]</span>
</span></span></code></pre></div><p>    这里可以记录一下Bitblt调用处的地址<code>1002706</code>，然后取消所有断点重新运行程序，将游戏切换到高级模式，随机点击一个地块。这里为了便于定位雷区数据位置，我们多次开局点击地块，直到仅连锁翻开一个地块（这样对雷区数据的影响较小，数据特征更明显）。</p>
<p><img src="/xingfen-star.github.io/post/reverse-program-course-week1/img/2025-02-19-18-31-58-image.png"
	width="1012"
	height="736"
	srcset="/xingfen-star.github.io/post/reverse-program-course-week1/img/2025-02-19-18-31-58-image_hu_788b97bba9d1a738.png 480w, /xingfen-star.github.io/post/reverse-program-course-week1/img/2025-02-19-18-31-58-image_hu_50dbfd47087318a1.png 1024w"
	loading="lazy"
	
		alt="高级模式点击地块结果"
	
	
		class="gallery-image" 
		data-flex-grow="137"
		data-flex-basis="330px"
	
></p>
<p>    然后将在数据窗口中<code>右键-&gt;转到-&gt;表达式</code>或者按<kbd>Ctrl</kbd> + <kbd>G</kbd>，输入内存读取部分的常量地址<code>1005A20</code>跳转到该地址。观察数据窗口内该地址处的数据。</p>
<p><img src="/xingfen-star.github.io/post/reverse-program-course-week1/img/2025-02-19-18-37-22-image.png"
	width="1190"
	height="789"
	srcset="/xingfen-star.github.io/post/reverse-program-course-week1/img/2025-02-19-18-37-22-image_hu_3ab6de150c66916a.png 480w, /xingfen-star.github.io/post/reverse-program-course-week1/img/2025-02-19-18-37-22-image_hu_8ccb0160d2c42480.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="150"
		data-flex-basis="361px"
	
></p>
<p>    发现并不符合雷区数据的特征（至少应该出现大量相同的两种数据）。实际上作为绘制雷区的函数，对数组下标的访问应该具有循环变量，也就是<code>esi</code>寄存器应该参与内存地址的计算，而这条指令并不符合。</p>
<p>    因此选择下面的指令来寻找雷区数据所在的内存地址。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nasm" data-lang="nasm"><span class="line"><span class="cl"><span class="nf">mov</span>    <span class="nb">al</span><span class="p">,</span> <span class="kt">byte</span> <span class="nv">ptr</span> <span class="p">[</span><span class="nb">ebx</span><span class="o">+</span><span class="nb">esi</span><span class="p">]</span>
</span></span></code></pre></div><p>    在这条指令上打断点后最小化扫雷窗口，再恢复窗口，查看ebx寄存器的值，发现是内存地址<code>1005360</code>，在数据窗口中跟踪该地址。</p>
<p><img src="/xingfen-star.github.io/post/reverse-program-course-week1/img/2025-02-19-18-44-59-image.png"
	width="2673"
	height="694"
	srcset="/xingfen-star.github.io/post/reverse-program-course-week1/img/2025-02-19-18-44-59-image_hu_8d337a5e391533ef.png 480w, /xingfen-star.github.io/post/reverse-program-course-week1/img/2025-02-19-18-44-59-image_hu_9dcbd54da11e63c0.png 1024w"
	loading="lazy"
	
		alt="查看ebx寄存器的值"
	
	
		class="gallery-image" 
		data-flex-grow="385"
		data-flex-basis="924px"
	
></p>
<p>    该地址处的内存数据如下。可以大致推测，未翻开的雷区和未翻开的空白对应数据为0x0F或0x8F。</p>
<p><img src="/xingfen-star.github.io/post/reverse-program-course-week1/img/2025-02-19-18-46-55-image.png"
	width="1185"
	height="651"
	srcset="/xingfen-star.github.io/post/reverse-program-course-week1/img/2025-02-19-18-46-55-image_hu_742488e62c40cd7b.png 480w, /xingfen-star.github.io/post/reverse-program-course-week1/img/2025-02-19-18-46-55-image_hu_37cf2a5e1a430a6e.png 1024w"
	loading="lazy"
	
		alt="雷区数据地址内容"
	
	
		class="gallery-image" 
		data-flex-grow="182"
		data-flex-basis="436px"
	
></p>
<p>    再次重开游戏，翻开第一个地块以定位数据区域首个元素的位置，如下图所示。</p>
<p><img src="/xingfen-star.github.io/post/reverse-program-course-week1/img/2025-02-19-18-53-45-image.png"
	width="1892"
	height="410"
	srcset="/xingfen-star.github.io/post/reverse-program-course-week1/img/2025-02-19-18-53-45-image_hu_9361cf30f96f7b26.png 480w, /xingfen-star.github.io/post/reverse-program-course-week1/img/2025-02-19-18-53-45-image_hu_65944666eab97190.png 1024w"
	loading="lazy"
	
		alt="定位雷区数据"
	
	
		class="gallery-image" 
		data-flex-grow="461"
		data-flex-basis="1107px"
	
></p>
<p>    对比可知<code>1005361</code>为首的地址存放雷区数据。</p>
<h3 id="分析地块状态对应的内存值">分析地块状态对应的内存值
</h3><h4 id="非雷区地块">非雷区地块
</h4><p>    从上一节的最后一个图可以得知，翻开的<code>2</code>地块对应的内存值为<code>0x42</code>。推测翻开的<code>n</code>对应的内存值为<code>0x4n</code>。</p>
<p>    翻开相邻地块进行验证，可知推测成立，同时也得知<code>未翻开的非雷区</code>对应的内存值为<code>0x0F</code>。</p>
<p><img src="/xingfen-star.github.io/post/reverse-program-course-week1/img/2025-02-19-19-00-18-image.png"
	width="458"
	height="243"
	srcset="/xingfen-star.github.io/post/reverse-program-course-week1/img/2025-02-19-19-00-18-image_hu_4466dcb44c231f74.png 480w, /xingfen-star.github.io/post/reverse-program-course-week1/img/2025-02-19-19-00-18-image_hu_3de12c325913b829.png 1024w"
	loading="lazy"
	
		alt="分析非雷区地块"
	
	
		class="gallery-image" 
		data-flex-grow="188"
		data-flex-basis="452px"
	
></p>
<h4 id="雷区地块">雷区地块
</h4><p>    再次观察内存区域，在9个地块后，有一个地块的内存值为不同的<code>0x8F</code>，翻开该地块后再次观察内存区域变化。</p>
<p><img src="/xingfen-star.github.io/post/reverse-program-course-week1/img/2025-02-19-19-03-34-image.png"
	width="1831"
	height="600"
	srcset="/xingfen-star.github.io/post/reverse-program-course-week1/img/2025-02-19-19-03-34-image_hu_3f5519681b2e6707.png 480w, /xingfen-star.github.io/post/reverse-program-course-week1/img/2025-02-19-19-03-34-image_hu_c10dd7aa64ec92a1.png 1024w"
	loading="lazy"
	
		alt="分析雷区地块"
	
	
		class="gallery-image" 
		data-flex-grow="305"
		data-flex-basis="732px"
	
></p>
<p>    可知<code>未翻开的雷</code>为<code>0x8F</code>，<code>翻开的雷</code>为<code>0x8A</code>，<code>踩中的雷</code>为<code>0xCC</code>。</p>
<h4 id="插旗地块与存疑地块">插旗地块与存疑地块
</h4><p>    重开游戏并刷新数据窗口。在任意<code>0x8E</code>和<code>0x0F</code>对应的地块上右键以插旗后，刷新数据窗口，观察对应数据变化。扫雷游戏中还有一种标记，在插旗的地块上再次右键可以变为问号地块，这里称为存疑地块，与本次任务并不相关，但是这里还是给出其对应的内存值。</p>
<p><img src="/xingfen-star.github.io/post/reverse-program-course-week1/img/2025-02-19-19-10-27-image.png"
	width="475"
	height="328"
	srcset="/xingfen-star.github.io/post/reverse-program-course-week1/img/2025-02-19-19-10-27-image_hu_29c7d70c93ced5e2.png 480w, /xingfen-star.github.io/post/reverse-program-course-week1/img/2025-02-19-19-10-27-image_hu_916d75149b8965ca.png 1024w"
	loading="lazy"
	
		alt="分析插旗地块与存疑地块"
	
	
		class="gallery-image" 
		data-flex-grow="144"
		data-flex-basis="347px"
	
></p>
<p>    观察上图可知，插旗地块的<code>0x?F</code>被替换为<code>0x?E</code>，存疑地块的<code>0x?F</code>被替换为<code>0x?D</code>。</p>
<hr>
<p><strong>至此，所有地块状态对应的内存值均被我们分析出来。</strong></p>
<p>    简单总结一下，地块状态对应的内存值如下：</p>
<div class="table-wrapper"><table>
  <thead>
      <tr>
          <th style="text-align: center">地块状态</th>
          <th style="text-align: left">内存值</th>
          <th style="text-align: center">地块状态</th>
          <th>内存值</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: center">未翻开的空地</td>
          <td style="text-align: left">0x0F</td>
          <td style="text-align: center">插旗的空地</td>
          <td>0x0E</td>
      </tr>
      <tr>
          <td style="text-align: center">翻开的空地</td>
          <td style="text-align: left">0x4n(n为要显示的数字)</td>
          <td style="text-align: center">存疑的空地</td>
          <td>0x0D</td>
      </tr>
      <tr>
          <td style="text-align: center">未翻开的地雷</td>
          <td style="text-align: left">0x8F</td>
          <td style="text-align: center">插旗的地雷</td>
          <td>0x8E</td>
      </tr>
      <tr>
          <td style="text-align: center">翻开的地雷</td>
          <td style="text-align: left">0x8A</td>
          <td style="text-align: center">存疑的地雷</td>
          <td>0x8D</td>
      </tr>
      <tr>
          <td style="text-align: center">踩中的地雷</td>
          <td style="text-align: left">0xCC</td>
          <td style="text-align: center"></td>
          <td></td>
      </tr>
  </tbody>
</table></div>
<p>    此外，按<kbd>Ctrl</kbd> + <kbd>↓</kbd>调整数据窗口首列数据从0x01偏移开始展示，可以发现在高级模式下30 * 16的布局下，每30个地块的数据后都有两个<code>0x10</code>，用于标注此行结束，在后面编写程序时，应当注意处理这个间隔区域。</p>
<p><img src="/xingfen-star.github.io/post/reverse-program-course-week1/img/2025-02-19-21-09-51-image.png"
	width="1477"
	height="759"
	srcset="/xingfen-star.github.io/post/reverse-program-course-week1/img/2025-02-19-21-09-51-image_hu_60d6265e00cc9ba1.png 480w, /xingfen-star.github.io/post/reverse-program-course-week1/img/2025-02-19-21-09-51-image_hu_3ff7a0237d6312a8.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="194"
		data-flex-basis="467px"
	
></p>
<h3 id="编写程序以批量插旗地雷">编写程序以批量插旗地雷
</h3><p>    程序如下：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;windows.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;tchar.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;tlhelp32.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="cp">#define GET_OFFSET(ROW, COL) ((ROW) * 32 + (COL))
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">print_sign</span><span class="p">(</span><span class="n">BYTE</span> <span class="n">val</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">val</span> <span class="o">==</span> <span class="mh">0x0F</span> <span class="o">||</span> <span class="n">val</span> <span class="o">==</span> <span class="mh">0x8F</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;--&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">val</span> <span class="o">==</span> <span class="mh">0x0E</span> <span class="o">||</span> <span class="n">val</span> <span class="o">==</span> <span class="mh">0x8E</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;||&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">val</span> <span class="o">==</span> <span class="mh">0x0D</span> <span class="o">||</span> <span class="n">val</span> <span class="o">==</span> <span class="mh">0x8D</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;??&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">val</span> <span class="o">==</span> <span class="mh">0x40</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;..&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">val</span> <span class="o">==</span> <span class="mh">0x8A</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;**&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">val</span> <span class="o">==</span> <span class="mh">0xCC</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;XX&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">val</span> <span class="o">==</span> <span class="mh">0x10</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;%01X&#34;</span><span class="p">,</span> <span class="n">val</span> <span class="o">&amp;</span> <span class="mh">0x0F</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;%01X&#34;</span><span class="p">,</span> <span class="n">val</span> <span class="o">&amp;</span> <span class="mh">0x0F</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34; &#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">DWORD</span> <span class="n">pid</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>          <span class="c1">// Target process ID
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">HANDLE</span> <span class="n">hProcess</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">LPVOID</span> <span class="n">targetAddress</span> <span class="o">=</span> <span class="p">(</span><span class="n">LPVOID</span><span class="p">)</span><span class="mh">0x1005361</span><span class="p">;</span> <span class="c1">// Target memory address
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">BYTE</span> <span class="n">readBuffer</span><span class="p">[</span><span class="mi">512</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">};</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// BYTE writeData[4] = {0xAA, 0xBB, 0xCC, 0xDD}; // Example data to write
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">SIZE_T</span> <span class="n">bytesRead</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// SIZE_T bytesWritten = 0;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">    <span class="c1">// Create a snapshot of all processes
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">HANDLE</span> <span class="n">hSnapshot</span> <span class="o">=</span> <span class="nf">CreateToolhelp32Snapshot</span><span class="p">(</span><span class="n">TH32CS_SNAPPROCESS</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">hSnapshot</span> <span class="o">==</span> <span class="n">INVALID_HANDLE_VALUE</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;Failed to create process snapshot, error code: %d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="nf">GetLastError</span><span class="p">());</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">PROCESSENTRY32</span> <span class="n">pe</span> <span class="o">=</span> <span class="p">{</span><span class="k">sizeof</span><span class="p">(</span><span class="n">PROCESSENTRY32</span><span class="p">)};</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nf">Process32First</span><span class="p">(</span><span class="n">hSnapshot</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">pe</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">do</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="nf">_tcsicmp</span><span class="p">(</span><span class="n">pe</span><span class="p">.</span><span class="n">szExeFile</span><span class="p">,</span> <span class="nf">_T</span><span class="p">(</span><span class="s">&#34;winmine.exe&#34;</span><span class="p">))</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">pid</span> <span class="o">=</span> <span class="n">pe</span><span class="p">.</span><span class="n">th32ProcessID</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;Process found: winmine.exe, PID: %u</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">pid</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span> <span class="k">while</span> <span class="p">(</span><span class="nf">Process32Next</span><span class="p">(</span><span class="n">hSnapshot</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">pe</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;Failed to retrieve process information, error code: %d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="nf">GetLastError</span><span class="p">());</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nf">CloseHandle</span><span class="p">(</span><span class="n">hSnapshot</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">pid</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;Process winmine.exe not found</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// Open the target process with required permissions for memory operations
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">hProcess</span> <span class="o">=</span> <span class="nf">OpenProcess</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">PROCESS_VM_READ</span> <span class="o">|</span> <span class="n">PROCESS_VM_WRITE</span> <span class="o">|</span> <span class="n">PROCESS_VM_OPERATION</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">FALSE</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">pid</span>
</span></span><span class="line"><span class="cl">    <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">hProcess</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;Failed to open process, error code: %d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="nf">GetLastError</span><span class="p">());</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// Read memory content
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nf">ReadProcessMemory</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">hProcess</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">targetAddress</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">readBuffer</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="k">sizeof</span><span class="p">(</span><span class="n">readBuffer</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">        <span class="o">&amp;</span><span class="n">bytesRead</span>
</span></span><span class="line"><span class="cl">    <span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;Failed to read memory, error code: %d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="nf">GetLastError</span><span class="p">());</span>
</span></span><span class="line"><span class="cl">        <span class="nf">CloseHandle</span><span class="p">(</span><span class="n">hProcess</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;Read %d bytes of data:</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">bytesRead</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">16</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="mi">32</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nf">print_sign</span><span class="p">(</span><span class="n">readBuffer</span><span class="p">[</span><span class="nf">GET_OFFSET</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)]);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;Start flaging all the mines..</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// Write to memory
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kt">int</span> <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">16</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="mi">32</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">BYTE</span> <span class="n">flag_mine</span> <span class="o">=</span> <span class="mh">0x8E</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="n">readBuffer</span><span class="p">[</span><span class="nf">GET_OFFSET</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)]</span> <span class="o">==</span> <span class="mh">0x8F</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nf">WriteProcessMemory</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">                    <span class="n">hProcess</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="n">targetAddress</span> <span class="o">+</span> <span class="nf">GET_OFFSET</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">                    <span class="o">&amp;</span><span class="n">flag_mine</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="k">sizeof</span><span class="p">(</span><span class="n">flag_mine</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">                    <span class="nb">NULL</span>
</span></span><span class="line"><span class="cl">                <span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="n">count</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;Finish! the count of mines: %d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">count</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nf">CloseHandle</span><span class="p">(</span><span class="n">hProcess</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// system(&#34;pause&#34;);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>    这段程序将会在打印雷区当前状态后，将所有<code>0x8F</code>修改为<code>0x8E</code>，即将所有的未翻开的地雷插上旗子，用户应当在新一局游戏内翻开任意地块后运行此程序，然后最小化再恢复窗口以重新绘制雷区。</p>
<p>    打印当前状态过程中，未翻开的所有地块将记为<code>--</code>，插旗地块记为<code>||</code>，翻开的空地记为<code>..</code>，翻开的数字地块记为该数字，翻开的地雷记为<code>**</code>，踩中的地雷记为<code>XX</code>。</p>
<h3 id="实验结果">实验结果
</h3><p>    运行结果如下图所示：</p>
<p><img src="/xingfen-star.github.io/post/reverse-program-course-week1/img/2025-02-19-21-46-38-image.png"
	width="2740"
	height="786"
	srcset="/xingfen-star.github.io/post/reverse-program-course-week1/img/2025-02-19-21-46-38-image_hu_b37f15a726c17c6e.png 480w, /xingfen-star.github.io/post/reverse-program-course-week1/img/2025-02-19-21-46-38-image_hu_1043f10725a825a4.png 1024w"
	loading="lazy"
	
		alt="终端输出及刷新前窗口"
	
	
		class="gallery-image" 
		data-flex-grow="348"
		data-flex-basis="836px"
	
></p>
<p>    刷新窗口后成功插旗。</p>
<p><img src="/xingfen-star.github.io/post/reverse-program-course-week1/img/2025-02-19-21-47-09-image.png"
	width="1000"
	height="638"
	srcset="/xingfen-star.github.io/post/reverse-program-course-week1/img/2025-02-19-21-47-09-image_hu_76003162ad918b5b.png 480w, /xingfen-star.github.io/post/reverse-program-course-week1/img/2025-02-19-21-47-09-image_hu_6d4f920b22d7227e.png 1024w"
	loading="lazy"
	
		alt="插旗结果截图"
	
	
		class="gallery-image" 
		data-flex-grow="156"
		data-flex-basis="376px"
	
></p>
<p>    降低雷数为20后重新运行，便于验证结果正确性，手动翻开所有未插旗地块，中间笑脸图标带上墨镜（表示游戏胜利），可见结果正确。</p>
<p><img src="/xingfen-star.github.io/post/reverse-program-course-week1/img/2025-02-19-21-49-06-image.png"
	width="2751"
	height="774"
	srcset="/xingfen-star.github.io/post/reverse-program-course-week1/img/2025-02-19-21-49-06-image_hu_36d87fdcdea16713.png 480w, /xingfen-star.github.io/post/reverse-program-course-week1/img/2025-02-19-21-49-06-image_hu_477f800bbf21e263.png 1024w"
	loading="lazy"
	
		alt="游戏胜利截图"
	
	
		class="gallery-image" 
		data-flex-grow="355"
		data-flex-basis="853px"
	
></p>
<h2 id="更换机器指令表exe显示字体">更换机器指令表.exe显示字体
</h2><h3 id="定位控制字体显示的winapi">定位控制字体显示的WinAPI
</h3><p>    使用Ollydbg打开机器指令表.exe。</p>
<p><img src="/xingfen-star.github.io/post/reverse-program-course-week1/img/2025-02-20-09-06-15-image.png"
	width="1059"
	height="883"
	srcset="/xingfen-star.github.io/post/reverse-program-course-week1/img/2025-02-20-09-06-15-image_hu_e765a714dcd93a9c.png 480w, /xingfen-star.github.io/post/reverse-program-course-week1/img/2025-02-20-09-06-15-image_hu_7a4c357c79a2a313.png 1024w"
	loading="lazy"
	
		alt="使用Ollydbg打开机器指令表.exe"
	
	
		class="gallery-image" 
		data-flex-grow="119"
		data-flex-basis="287px"
	
></p>
<p>    在API文档及网络资料中查询其内涉及的API。</p>
<hr>
<div class="table-wrapper"><table>
  <thead>
      <tr>
          <th>API名称</th>
          <th>功能</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>GetModuleHandle</td>
          <td>检索指定模块的模块句柄。模块必须已由调用进程加载。</td>
      </tr>
      <tr>
          <td>GetCommandLine</td>
          <td>检索当前进程的命令行字符串。</td>
      </tr>
      <tr>
          <td>ExitProcess</td>
          <td>结束调用进程及其所有线程。</td>
      </tr>
      <tr>
          <td>GetSystemMetrics</td>
          <td>用于获取关于显示器、鼠标、键盘等系统参数的信息。</td>
      </tr>
  </tbody>
</table></div>
<p>    观察发现在程序有效的程序段中涉及的三个WinAPI均与字体显示无关。还剩下一个<code>call 004031</code>，推测其很可能控制字体的显示。其上的四个push可能包含参数，尝试修改为<code>push 0D</code> 观察程序变化。修改两个push后运行程序并无明显变化。可见这两个参数并不控制该程序的字体显示。</p>
<p>    在<code>call 00401031</code>处设断点并单步步入，依次检索遇见的到的WinAPI功能。</p>
<div class="table-wrapper"><table>
  <thead>
      <tr>
          <th>API名称</th>
          <th>功能</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>CreateWindowEx</td>
          <td>用于创建一个窗口（包括各种控件如按钮、文本框等）。</td>
      </tr>
      <tr>
          <td>SetWindowLong</td>
          <td>更改指定窗口的属性。该函数还将指定偏移量处的32位(长)值设置为额外的窗口内存。</td>
      </tr>
      <tr>
          <td>GetStockObject</td>
          <td>用于获取预定义的图形对象（如画笔、画刷和字体）的句柄。</td>
      </tr>
  </tbody>
</table></div>
<p>    其中GetStockObject涉及字体的显示，在<code>4010C6</code>处调用，其上一条指令<code>push 0B</code>很可能控制字体的显示。</p>
<p><img src="/xingfen-star.github.io/post/reverse-program-course-week1/img/2025-02-20-09-35-35-image.png"
	width="1098"
	height="137"
	srcset="/xingfen-star.github.io/post/reverse-program-course-week1/img/2025-02-20-09-35-35-image_hu_e4c98cf7b0593171.png 480w, /xingfen-star.github.io/post/reverse-program-course-week1/img/2025-02-20-09-35-35-image_hu_c2e474729a5d2f.png 1024w"
	loading="lazy"
	
		alt="GetStockObject上下文"
	
	
		class="gallery-image" 
		data-flex-grow="801"
		data-flex-basis="1923px"
	
></p>
<p>    将<code>push 0B</code>修改为<code>push 0E</code>后继续运行程序，可见字体明显发生变化。</p>
<p><img src="/xingfen-star.github.io/post/reverse-program-course-week1/img/2025-02-20-09-37-42-image.png"
	width="1771"
	height="609"
	srcset="/xingfen-star.github.io/post/reverse-program-course-week1/img/2025-02-20-09-37-42-image_hu_eb4e0c2a3568dd5a.png 480w, /xingfen-star.github.io/post/reverse-program-course-week1/img/2025-02-20-09-37-42-image_hu_153526ad71bc3e21.png 1024w"
	loading="lazy"
	
		alt="修改参数后运行结果"
	
	
		class="gallery-image" 
		data-flex-grow="290"
		data-flex-basis="697px"
	
></p>
<h3 id="将修改保存到文件">将修改保存到文件
</h3><p>    选中被修改的指令，在指令窗口中右键-&gt;复制到可执行文件-&gt;选择，在弹出的新窗口中选中被修改的指令，右键-&gt;保存文件。将新可执行文件命名为<code>机器指令表2.exe</code>。</p>
<p><img src="/xingfen-star.github.io/post/reverse-program-course-week1/img/2025-02-20-09-42-35-image.png"
	width="2176"
	height="996"
	srcset="/xingfen-star.github.io/post/reverse-program-course-week1/img/2025-02-20-09-42-35-image_hu_4e8ca5a7b96065ad.png 480w, /xingfen-star.github.io/post/reverse-program-course-week1/img/2025-02-20-09-42-35-image_hu_774087a40d705088.png 1024w"
	loading="lazy"
	
		alt="将修改保存到文件"
	
	
		class="gallery-image" 
		data-flex-grow="218"
		data-flex-basis="524px"
	
></p>
<p>    双击运行修改前后的机器指令表，对比两者的字体差异。</p>
<p><img src="/xingfen-star.github.io/post/reverse-program-course-week1/img/2025-02-20-09-44-35-image.png"
	width="1070"
	height="381"
	srcset="/xingfen-star.github.io/post/reverse-program-course-week1/img/2025-02-20-09-44-35-image_hu_fe96750146e1561b.png 480w, /xingfen-star.github.io/post/reverse-program-course-week1/img/2025-02-20-09-44-35-image_hu_2d0c839334dee803.png 1024w"
	loading="lazy"
	
		alt="对比两个机器指令表的差异"
	
	
		class="gallery-image" 
		data-flex-grow="280"
		data-flex-basis="674px"
	
></p>

</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/xingfen-star.github.io/tags/%E8%BD%AF%E4%BB%B6%E9%80%86%E5%90%91/">软件逆向</a>
        
            <a href="/xingfen-star.github.io/tags/c%E8%AF%AD%E8%A8%80/">C语言</a>
        
    </section>


    <section class="article-lastmod">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



        <span>
            Last updated on Mar 15, 2025 08:00 UTC
        </span>
    </section></footer>


    
</article>

    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">Related content</h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="">
    <a href="/xingfen-star.github.io/post/c-getopt_h-analysis/">

        

        <div class="article-details">
            <h2 class="article-title">c语言getopt.h库解析</h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>


    
        
    

    <footer class="site-footer">
    <section class="copyright">
        &copy;
        
            2025 -
        
        2025 远楒
    </section>

    <section class="powerby">
        
            星藏点雪，月隐晦明 <br/>
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.29.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link
                rel="stylesheet"
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link
                rel="stylesheet"
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/xingfen-star.github.io/ts/main.1b68ca70253b523eabb06a943631ea672d424976a40c495cc6a889635f51d0f9.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>
<style>
    #TableOfContents > ul, ol {
        ul, ol {
            display: none;
        }
        .open {
            display: block;
        }
    }
</style>

<script>
    function initTocHide() {
        
        let toc = document.querySelector(".widget--toc");
        if (!toc) {
            return;
        }
        
        window.addEventListener('scroll', function() {
            
            let currentLi = document.querySelector(".active-class");
            if (!currentLi) {
                return
            }
            
            let elementsByClassName = document.querySelectorAll(".open");
            if (elementsByClassName.length > 0) {
                elementsByClassName.forEach((ul) => {
                    ul.classList.remove("open")
                })
            }
            
            if (currentLi.children.length > 1) {
                currentLi.children[1].classList.add("open")
            }
            
            let ul = currentLi.parentElement;
            do {
                ul.classList.add("open");
                ul = ul.parentElement.parentElement
            } while (ul !== undefined && (ul.localName === 'ul' || ul.localName === 'ol'))
        });
    }
    initTocHide()
</script>

    </body>
</html>
